<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>IDV Assignment 5 – Integrated Visualisations</title>
  <style>
    :root {
      /* A2 用到的 CSS 变量 */
      --cell-size: 200px;
      --a2-bg: #ffffff;
      --a2-border: #ffffff;
    }

    /* ===== 全局页面样式 ===== */
    body {
      font-family: Arial, sans-serif;
      background: #0f1424;
      color: #fff;
      margin: 20px;
    }

    h1, h2 {
      text-align: center;
    }

    h1 {
      color: #6c5ce7;
      margin-bottom: 5px;
    }

    h2 {
      margin-top: 40px;
      margin-bottom: 10px;
      color: #ffd86b;
    }

    .overview {
      max-width: 900px;
      margin: 0 auto 30px auto;
      background: #1d2a4a;
      padding: 15px 20px;
      border-radius: 8px;
      line-height: 1.6;
      font-size: 14px;
    }

    .assignment-section {
      max-width: 1000px;
      margin: 0 auto 40px auto;
    }

    .assignment-desc {
      font-size: 14px;
      color: #ccc;
      margin-bottom: 10px;
      text-align: left;
    }

    /* ===== A1 专属样式 ===== */
    #a1-section table {
      width: 100%;
      border-collapse: collapse;
      background: #1d2a4a;
      border-radius: 8px;
      overflow: hidden;
    }

    #a1-section th,
    #a1-section td {
      border: 1px solid #333;
      padding: 8px;
      text-align: center;
      font-size: 13px;
    }

    #a1-section th {
      background: #2e3b5a;
    }

    #a1-section tr:hover {
      background: #2f3c60;
    }

    #a1-update {
      text-align: center;
      margin: 15px 0;
      color: #aaa;
      font-size: 13px;
    }

    /* ===== A2 专属样式（全部限制在 #a2-section 里面） ===== */
    #a2-section {
      background: #111827;
      padding: 20px;
      border-radius: 10px;
    }

    #a2-section .a2-table-wrapper {
      overflow-x: auto; /* 防止横向溢出 */
      background: #111827;
    }

    #a2-section .a2-table {
      width: 100%;
      border-collapse: collapse;
      background: var(--a2-bg);
      table-layout: fixed; /* 保持列宽稳定 */
    }

    #a2-section .a2-table th,
    #a2-section .a2-table td {
      border: 1px solid var(--a2-border);
      text-align: center;
      padding: 0;
      background: #ffffff;
      color: #111827;
    }

    #a2-section .table-title-row th {
      background-color: #c27ba0;
      font-size: 1.5em;
      border: 2px solid var(--a2-border);
      height: 60px;
    }

    #a2-section .cell {
      height: var(--cell-size);
    }

    /* frame 填满单元格，居中图片 */
    #a2-section .frame {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;    /* 垂直居中 */
      justify-content: center;/* 水平居中 */
      overflow: hidden;
      background: #ffffff;
    }

    #a2-section .frame img {
      max-width: 50%;
      max-height: 50%;
      display: block;
      will-change: transform, filter;
      transform-origin: center center;
      image-rendering: auto;
    }

    /* 变换效果 */
    #a2-section .mirror img    { transform: scaleX(-1); }
    #a2-section .rotate180 img { transform: rotate(180deg); }
    #a2-section .squeezeY img  { transform: scaleY(0.5); }
    #a2-section .grayscale img { filter: grayscale(100%); }
  </style>
</head>
<body>

  <!-- 顶部 overview -->
  <h1>IDV Assignment 5 – Integrated Page (A1–A4)</h1>
  <div class="overview">
    <p>
      这个页面整合了我在 IDV 课程中的四次作业（Assignment 1–4），
      统一放在一个网页中展示。每一部分保留了原有的交互和可视化效果。
    </p>
    <p>
      在整合过程中，我需要处理不同作业之间的 HTML 结构、样式（CSS）
      和脚本（JavaScript）冲突，例如重复的 ID、全局样式覆盖等。
      我通过为每个作业划分独立的 section，并给元素添加更具体的选择器，
      来保证它们可以在同一页面正常工作。
    </p>
    <p>
      （后面可以再补：哪个作业最难整合、为什么，以及具体遇到的困难。）
    </p>
  </div>

  <!-- ===== Assignment 1 区域 ===== -->
  <section id="a1-section" class="assignment-section">
    <h2>Assignment 1 – 新加坡空气质量实时监测</h2>
    <div class="assignment-desc">
      使用新加坡政府公开 API 获取 PSI 空气质量数据，
      并将不同指标在各个区域的数值以表格形式实时展示，每分钟自动更新一次。
    </div>

    <div id="a1-update">正在获取数据...</div>
    <table id="a1-data-table">
      <thead>
        <tr>
          <th>指标</th>
          <th>中央</th>
          <th>东部</th>
          <th>西部</th>
          <th>南部</th>
          <th>北部</th>
          <th>全国</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <!-- ===== Assignment 2 区域 ===== -->
  <section id="a2-section" class="assignment-section">
    <h2>Assignment 2 – SVG Transformations Grid</h2>
    <div class="assignment-desc">
      通过一组 SVG 图像展示不同的几何与视觉变换：
      原图、镜像、旋转 180°、纵向压缩、灰度等，
      用表格方式对比同一图形在不同变换下的效果。
    </div>

    <div class="a2-table-wrapper">
      <table class="a2-table">
        <thead>
          <tr class="table-title-row">
            <th colspan="5">Submission for Assignment 2</th>
          </tr>
          <tr>
            <th>ORIGINAL</th>
            <th>MIRROR</th>
            <th>ROTATE 180</th>
            <th>SQUEEZE</th>
            <th>GRAYSCALE</th>
          </tr>
        </thead>

        <tbody>
          <tr>
            <td class="cell"><div class="frame"><img src="one.svg" alt="original one.svg"></div></td>
            <td class="cell"><div class="frame mirror"><img src="one.svg" alt="mirror one.svg"></div></td>
            <td class="cell"><div class="frame rotate180"><img src="one.svg" alt="rotate180 one.svg"></div></td>
            <td class="cell"><div class="frame squeezeY"><img src="one.svg" alt="squeezeY one.svg"></div></td>
            <td class="cell"><div class="frame grayscale"><img src="one.svg" alt="grayscale one.svg"></div></td>
          </tr>

          <tr>
            <td class="cell"><div class="frame"><img src="two.svg" alt="original two.svg"></div></td>
            <td class="cell"><div class="frame mirror"><img src="two.svg" alt="mirror two.svg"></div></td>
            <td class="cell"><div class="frame rotate180"><img src="two.svg" alt="rotate180 two.svg"></div></td>
            <td class="cell"><div class="frame squeezeY"><img src="two.svg" alt="squeezeY two.svg"></div></td>
            <td class="cell"><div class="frame grayscale"><img src="two.svg" alt="grayscale two.svg"></div></td>
          </tr>

          <tr>
            <td class="cell"><div class="frame"><img src="three.svg" alt="original three.svg"></div></td>
            <td class="cell"><div class="frame mirror"><img src="three.svg" alt="mirror three.svg"></div></td>
            <td class="cell"><div class="frame rotate180"><img src="three.svg" alt="rotate180 three.svg"></div></td>
            <td class="cell"><div class="frame squeezeY"><img src="three.svg" alt="squeezeY three.svg"></div></td>
            <td class="cell"><div class="frame grayscale"><img src="three.svg" alt="grayscale three.svg"></div></td>
          </tr>

          <tr>
            <td class="cell"><div class="frame"><img src="four.svg" alt="original four.svg"></div></td>
            <td class="cell"><div class="frame mirror"><img src="four.svg" alt="mirror four.svg"></div></td>
            <td class="cell"><div class="frame rotate180"><img src="four.svg" alt="rotate180 four.svg"></div></td>
            <td class="cell"><div class="frame squeezeY"><img src="four.svg" alt="squeezeY four.svg"></div></td>
            <td class="cell"><div class="frame grayscale"><img src="four.svg" alt="grayscale four.svg"></div></td>
          </tr>

          <tr>
            <td class="cell"><div class="frame"><img src="five.svg" alt="original five.svg"></div></td>
            <td class="cell"><div class="frame mirror"><img src="five.svg" alt="mirror five.svg"></div></td>
            <td class="cell"><div class="frame rotate180"><img src="five.svg" alt="rotate180 five.svg"></div></td>
            <td class="cell"><div class="frame squeezeY"><img src="five.svg" alt="squeezeY five.svg"></div></td>
            <td class="cell"><div class="frame grayscale"><img src="five.svg" alt="grayscale five.svg"></div></td>
          </tr>

          <tr>
            <td class="cell"><div class="frame"><img src="six.svg" alt="original six.svg"></div></td>
            <td class="cell"><div class="frame mirror"><img src="six.svg" alt="mirror six.svg"></div></td>
            <td class="cell"><div class="frame rotate180"><img src="six.svg" alt="rotate180 six.svg"></div></td>
            <td class="cell"><div class="frame squeezeY"><img src="six.svg" alt="squeezeY six.svg"></div></td>
            <td class="cell"><div class="frame grayscale"><img src="six.svg" alt="grayscale six.svg"></div></td>
          </tr>

          <tr>
            <td class="cell"><div class="frame"><img src="seven.svg" alt="original seven.svg"></div></td>
            <td class="cell"><div class="frame mirror"><img src="seven.svg" alt="mirror seven.svg"></div></td>
            <td class="cell"><div class="frame rotate180"><img src="seven.svg" alt="rotate180 seven.svg"></div></td>
            <td class="cell"><div class="frame squeezeY"><img src="seven.svg" alt="squeezeY seven.svg"></div></td>
            <td class="cell"><div class="frame grayscale"><img src="seven.svg" alt="grayscale seven.svg"></div></td>
          </tr>

          <tr>
            <td class="cell"><div class="frame"><img src="eight.svg" alt="original eight.svg"></div></td>
            <td class="cell"><div class="frame mirror"><img src="eight.svg" alt="mirror eight.svg"></div></td>
            <td class="cell"><div class="frame rotate180"><img src="eight.svg" alt="rotate180 eight.svg"></div></td>
            <td class="cell"><div class="frame squeezeY"><img src="eight.svg" alt="squeezeY eight.svg"></div></td>
            <td class="cell"><div class="frame grayscale"><img src="eight.svg" alt="grayscale eight.svg"></div></td>
          </tr>

          <tr>
            <td class="cell"><div class="frame"><img src="nine.svg" alt="original nine.svg"></div></td>
            <td class="cell"><div class="frame mirror"><img src="nine.svg" alt="mirror nine.svg"></div></td>
            <td class="cell"><div class="frame rotate180"><img src="nine.svg" alt="rotate180 nine.svg"></div></td>
            <td class="cell"><div class="frame squeezeY"><img src="nine.svg" alt="squeezeY nine.svg"></div></td>
            <td class="cell"><div class="frame grayscale"><img src="nine.svg" alt="grayscale nine.svg"></div></td>
          </tr>

          <tr>
            <td class="cell"><div class="frame"><img src="ten.svg" alt="original ten.svg"></div></td>
            <td class="cell"><div class="frame mirror"><img src="ten.svg" alt="mirror ten.svg"></div></td>
            <td class="cell"><div class="frame rotate180"><img src="ten.svg" alt="rotate180 ten.svg"></div></td>
            <td class="cell"><div class="frame squeezeY"><img src="ten.svg" alt="squeezeY ten.svg"></div></td>
            <td class="cell"><div class="frame grayscale"><img src="ten.svg" alt="grayscale ten.svg"></div></td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <!-- 之后这里再接 A3 / A4 的 section -->

  <script>
    // ===== A1：新加坡空气质量实时监测 =====
    function setupAssignment1() {
      const labels = {
        "o3_sub_index": "臭氧子指数 (O₃)",
        "pm10_twenty_four_hourly": "PM₁₀ 24小时平均浓度",
        "pm10_sub_index": "PM₁₀ 子指数",
        "co_sub_index": "一氧化碳子指数 (CO)",
        "pm25_twenty_four_hourly": "PM₂.₅ 24小时平均浓度",
        "so2_sub_index": "二氧化硫子指数 (SO₂)",
        "co_eight_hour_max": "一氧化碳8小时最大值",
        "no2_one_hour_max": "二氧化氮1小时最大值 (NO₂)",
        "so2_twenty_four_hourly": "二氧化硫24小时平均浓度",
        "pm25_sub_index": "PM₂.₅ 子指数",
        "psi_twenty_four_hourly": "空气污染指数 (PSI)",
        "o3_eight_hour_max": "臭氧8小时最大值"
      };

      const tbody = document.querySelector("#a1-data-table tbody");
      const update = document.getElementById("a1-update");

      async function loadData() {
        try {
          const res = await fetch("https://api.data.gov.sg/v1/environment/psi");
          const json = await res.json();
          const readings = json.items[0].readings;
          const regions = Object.keys(readings.psi_twenty_four_hourly);

          const time = new Date(json.items[0].update_timestamp)
            .toLocaleString("zh-SG", { timeZone: "Asia/Singapore" });
          update.textContent = `最后更新：${time}`;

          tbody.innerHTML = "";

          for (const key in readings) {
            const row = document.createElement("tr");
            const label = labels[key] || key;
            row.innerHTML =
              `<td>${label}</td>` +
              regions.map(r => `<td>${readings[key][r]}</td>`).join("");
            tbody.appendChild(row);
          }
        } catch (err) {
          console.error(err);
          update.textContent = "数据加载失败，请稍后重试。";
        }
      }

      // 初始化 & 每分钟刷新
      loadData();
      setInterval(loadData, 60000);
    }

    // 页面加载完成后初始化
    document.addEventListener("DOMContentLoaded", function () {
      setupAssignment1();
      // 以后在这里加：setupAssignment3(); setupAssignment4();
    });
  </script>
</body>
</html>
