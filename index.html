<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assignment 5 - æ•´åˆä½œä¸šå±•ç¤º</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        /* ==================== å…¨å±€æ ·å¼ ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: #f5f7fa;
            color: #333;
            line-height: 1.6;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            overflow-x: hidden;
        }
        
        /* ==================== é¡¶éƒ¨å¯¼èˆªå’Œæ¦‚è¿° ==================== */
        .overview-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .overview-section h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .overview-content {
            background: rgba(255,255,255,0.1);
            padding: 25px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .overview-content h3 {
            color: #ffde59;
            margin-bottom: 15px;
        }
        
        .overview-content p {
            margin-bottom: 12px;
        }
        
        .overview-content ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        /* ==================== ä½œä¸šæ¨¡å—ç»Ÿä¸€æ ·å¼ ==================== */
        .assignment-module {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            transition: transform 0.3s ease;
        }
        
        .assignment-module:hover {
            transform: translateY(-5px);
        }
        
        .module-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid;
        }
        
        .module-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 1.5em;
            font-weight: bold;
            border-radius: 50%;
            margin-right: 20px;
        }
        
        .module-title {
            font-size: 1.8em;
            color: #2c3e50;
            margin: 0;
        }
        
        .module-description {
            color: #666;
            font-size: 1.1em;
            margin-top: 5px;
        }
        
        /* ==================== A1 ç‰¹æœ‰æ ·å¼ ==================== */
        #a1 .module-header {
            border-bottom-color: #3498db;
        }
        
        #a1 .module-number {
            background: #3498db;
        }
        
        .api-table {
            width: 100%;
            border-collapse: collapse;
            background: #1d2a4a;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .api-table th, .api-table td {
            border: 1px solid #333;
            padding: 10px;
            text-align: center;
        }
        
        .api-table th {
            background: #2e3b5a;
            color: white;
        }
        
        .api-table tr:hover {
            background: #2f3c60;
        }
        
        .api-update {
            text-align: center;
            margin: 15px 0;
            color: #666;
            font-style: italic;
        }
        
        /* ==================== A2 ç‰¹æœ‰æ ·å¼ ==================== */
        #a2 .module-header {
            border-bottom-color: #e74c3c;
        }
        
        #a2 .module-number {
            background: #e74c3c;
        }
        
        .svg-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            table-layout: fixed;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .svg-table th, .svg-table td {
            border: 1px solid #ddd;
            text-align: center;
            padding: 0;
        }
        
        .svg-table th {
            background-color: #c27ba0;
            font-size: 1.2em;
            border: 2px solid #ddd;
            height: 60px;
            color: white;
        }
        
        .svg-cell {
            height: 120px;
        }
        
        .svg-frame {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            background: #ffffff;
        }
        
        .svg-frame img {
            max-width: 60%;
            max-height: 60%;
            display: block;
            will-change: transform, filter;
            transform-origin: center center;
            image-rendering: auto;
        }
        
        .mirror img {
            transform: scaleX(-1);
        }
        
        .rotate180 img {
            transform: rotate(180deg);
        }
        
        .squeezeY img {
            transform: scaleY(0.5);
        }
        
        .grayscale img {
            filter: grayscale(100%);
        }
        
        /* ==================== A3 ç‰¹æœ‰æ ·å¼ ==================== */
        #a3 .module-header {
            border-bottom-color: #2ecc71;
        }
        
        #a3 .module-number {
            background: #2ecc71;
        }
        
        .chart-container {
            margin-top: 20px;
        }
        
        .chart-card {
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.06);
            padding: 20px;
            margin-bottom: 28px;
        }
        
        .chart-title {
            margin: 0 0 4px;
            color: #2c3e50;
        }
        
        .chart-subtitle {
            margin: 0 0 16px;
            color: #6b7280;
            font-size: 0.9rem;
        }
        
        .chart-note {
            margin-top: 12px;
            padding-top: 8px;
            border-top: 1px dashed #e5e7eb;
            font-size: 0.9rem;
            color: #374151;
            line-height: 1.5;
        }
        
        .chart-note strong {
            color: #111827;
        }
        
        .tooltip {
            position: absolute;
            background: rgba(17,24,39,0.95);
            color: #f9fafb;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 12px;
            pointer-events: none;
            line-height: 1.4;
        }
        
        /* ==================== A4 ç‰¹æœ‰æ ·å¼ ==================== */
        #a4 .module-header {
            border-bottom-color: #f39c12;
        }
        
        #a4 .module-number {
            background: #f39c12;
        }
        
        .heatmap-container {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        
        .heatmap-legend {
            margin-top: 20px;
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .color-bar {
            display: inline-block;
            width: 250px;
            height: 20px;
            background: linear-gradient(to right, #e74c3c, #f1c40f, #27ae60);
            margin: 0 10px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        
        /* ==================== å“åº”å¼è®¾è®¡ ==================== */
        @media (max-width: 1200px) {
            .svg-cell {
                height: 100px;
            }
            
            .heatmap-container {
                overflow-x: auto;
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .overview-section {
                padding: 20px;
            }
            
            .overview-section h1 {
                font-size: 1.8em;
            }
            
            .assignment-module {
                padding: 20px;
            }
            
            .module-header {
                flex-direction: column;
                text-align: center;
            }
            
            .module-number {
                margin-right: 0;
                margin-bottom: 15px;
            }
            
            .svg-cell {
                height: 80px;
            }
        }
        
        /* ==================== æ‰“å°æ ·å¼ ==================== */
        @media print {
            .assignment-module {
                break-inside: avoid;
                box-shadow: none;
                border: 1px solid #ddd;
            }
            
            .overview-section {
                background: white !important;
                color: black !important;
                box-shadow: none !important;
                border: 1px solid #ddd;
            }
        }
    </style>
</head>
<body>
    <!-- é¡¶éƒ¨æ¦‚è¿°éƒ¨åˆ† -->
    <section class="overview-section" id="overview">
        <h1>Assignment 5 - ä½œä¸šæ•´åˆå±•ç¤º</h1>
        <div class="overview-content">
            <h3>é¡µé¢å†…å®¹æ¦‚è¿°</h3>
            <p>æœ¬é¡µé¢æ•´åˆäº†Assignment 1-4çš„æ‰€æœ‰å†…å®¹ï¼Œå±•ç¤ºäº†å®Œæ•´çš„ä½œä¸šæˆæœã€‚é€šè¿‡ç»Ÿä¸€çš„å¸ƒå±€å’Œè®¾è®¡ï¼Œå°†å››ä¸ªç‹¬ç«‹çš„ä½œä¸šæ¨¡å—æ•´åˆæˆä¸€ä¸ªè¿è´¯çš„ç½‘é¡µã€‚</p>
            
            <h3>æ•´åˆè¿‡ç¨‹</h3>
            <p>æ•´åˆè¿‡ç¨‹ä¸­éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š</p>
            <ul>
                <li>ä¿æŒæ¯ä¸ªä½œä¸šåŸæœ‰åŠŸèƒ½çš„å®Œæ•´æ€§</li>
                <li>åˆ›å»ºç»Ÿä¸€çš„CSSæ ·å¼ç³»ç»Ÿï¼Œç¡®ä¿è§†è§‰ä¸€è‡´æ€§</li>
                <li>ä½¿ç”¨æ¨¡å—åŒ–å¸ƒå±€ï¼Œä½¿æ¯ä¸ªä½œä¸šæ¸…æ™°å¯è¾¨</li>
                <li>ä¼˜åŒ–å“åº”å¼è®¾è®¡ï¼Œç¡®ä¿åœ¨ä¸åŒè®¾å¤‡ä¸Šæ­£å¸¸æ˜¾ç¤º</li>
            </ul>
            
            <h3>é‡åˆ°çš„æŒ‘æˆ˜</h3>
            <p>ä¸»è¦æŒ‘æˆ˜åŒ…æ‹¬ï¼š</p>
            <ul>
                <li><strong>CSSå†²çªï¼š</strong>ä¸åŒä½œä¸šçš„æ ·å¼è§„åˆ™ç›¸äº’å½±å“ï¼Œéœ€è¦é‡æ„æ ·å¼ç³»ç»Ÿ</li>
                <li><strong>å¸ƒå±€å·®å¼‚ï¼š</strong>A1ä½¿ç”¨è¡¨æ ¼å¸ƒå±€ï¼ŒA2ä¹Ÿæ˜¯è¡¨æ ¼ä½†ç»“æ„ä¸åŒï¼ŒA3å’ŒA4ä½¿ç”¨D3.jså¯è§†åŒ–ï¼Œå¸ƒå±€æ–¹å¼å„å¼‚</li>
                <li><strong>è„šæœ¬å†²çªï¼š</strong>å„ä½œä¸šçš„JavaScriptä»£ç å¯èƒ½ä½¿ç”¨ç›¸åŒçš„å˜é‡åæˆ–å‡½æ•°å</li>
                <li><strong>æ€§èƒ½ä¼˜åŒ–ï¼š</strong>æ•´åˆå¤šä¸ªD3å¯è§†åŒ–å¯èƒ½å½±å“é¡µé¢åŠ è½½æ€§èƒ½</li>
            </ul>
            
            <h3>æœ€å›°éš¾çš„æ•´åˆéƒ¨åˆ†</h3>
            <p><strong>A3çš„æ•´åˆæœ€ä¸ºå›°éš¾ã€‚</strong>åŸå› å¦‚ä¸‹ï¼š</p>
            <ul>
                <li>A3åŒ…å«5ä¸ªç‹¬ç«‹çš„D3å›¾è¡¨ï¼Œæ¯ä¸ªéƒ½æœ‰å¤æ‚çš„äº¤äº’å’ŒåŠ¨ç”»</li>
                <li>å›¾è¡¨ä»£ç ç»“æ„ç´§å¯†è€¦åˆï¼Œéš¾ä»¥åˆ†ç¦»</li>
                <li>éœ€è¦ç¡®ä¿æ‰€æœ‰D3é€‰æ‹©å™¨åœ¨æ•´åˆåä»ç„¶æ­£ç¡®å·¥ä½œ</li>
                <li>å¤„ç†å¤šä¸ªå›¾è¡¨çš„tooltipç³»ç»Ÿéœ€è¦ç‰¹åˆ«å°å¿ƒï¼Œé¿å…å†²çª</li>
            </ul>
            
            <p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong>ä¸ºæ¯ä¸ªå›¾è¡¨åˆ›å»ºç‹¬ç«‹çš„å®¹å™¨ï¼Œå°è£…å„è‡ªçš„è„šæœ¬ï¼Œä½¿ç”¨ç«‹å³æ‰§è¡Œå‡½æ•°é¿å…å…¨å±€å˜é‡æ±¡æŸ“ï¼Œå¹¶ç»Ÿä¸€tooltipç³»ç»Ÿã€‚</p>
        </div>
    </section>

    <!-- A1: ç©ºæ°”è´¨é‡æ•°æ®è¡¨æ ¼ -->
    <section class="assignment-module" id="a1">
        <div class="module-header">
            <div class="module-number">1</div>
            <div>
                <h2 class="module-title">Assignment 1: æ–°åŠ å¡ç©ºæ°”è´¨é‡å®æ—¶ç›‘æµ‹</h2>
                <p class="module-description">ä½¿ç”¨APIè·å–å®æ—¶ç©ºæ°”è´¨é‡æ•°æ®ï¼Œå¹¶ä»¥è¡¨æ ¼å½¢å¼å±•ç¤º</p>
            </div>
        </div>
        
        <div id="a1-content">
            <div id="update" class="api-update">æ­£åœ¨è·å–æ•°æ®...</div>
            <table class="api-table" id="data-table">
                <thead>
                    <tr>
                        <th>æŒ‡æ ‡</th>
                        <th>ä¸­å¤®</th>
                        <th>ä¸œéƒ¨</th>
                        <th>è¥¿éƒ¨</th>
                        <th>å—éƒ¨</th>
                        <th>åŒ—éƒ¨</th>
                        <th>å…¨å›½</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </section>

    <!-- A2: SVGå˜æ¢è¡¨æ ¼ -->
    <section class="assignment-module" id="a2">
        <div class="module-header">
            <div class="module-number">2</div>
            <div>
                <h2 class="module-title">Assignment 2: SVGå›¾åƒå˜æ¢å±•ç¤º</h2>
                <p class="module-description">å±•ç¤ºSVGå›¾åƒçš„å„ç§å˜æ¢æ•ˆæœï¼šé•œåƒã€æ—‹è½¬ã€å‹ç¼©å’Œç°åº¦åŒ–</p>
            </div>
        </div>
        
        <div id="a2-content">
            <table class="svg-table">
                <thead>
                    <tr class="table-title-row">
                        <th colspan="5">SVG Transformations Gallery</th>
                    </tr>
                    <tr>
                        <th>ORIGINAL</th>
                        <th>MIRROR</th>
                        <th>ROTATE 180</th>
                        <th>SQUEEZE</th>
                        <th>GRAYSCALE</th>
                    </tr>
                </thead>
                <tbody id="svg-table-body">
                    <!-- SVGè¡¨æ ¼è¡Œå°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </tbody>
            </table>
        </div>
    </section>

    <!-- A3: D3å¯è§†åŒ–å›¾è¡¨ -->
    <section class="assignment-module" id="a3">
        <div class="module-header">
            <div class="module-number">3</div>
            <div>
                <h2 class="module-title">Assignment 3: D3äº¤äº’å¼å¯è§†åŒ–</h2>
                <p class="module-description">ä½¿ç”¨D3.jsåˆ›å»ºçš„äº”ä¸ªäº¤äº’å¼å›¾è¡¨ï¼ŒåŒ…å«è¿‡æ¸¡åŠ¨ç”»å’Œæ‚¬åœæ•ˆæœ</p>
            </div>
        </div>
        
        <div id="a3-content" class="chart-container">
            <!-- Chart 7: Venn Diagram -->
            <div class="chart-card">
                <h3 class="chart-title">Chart 7 â€” Venn Diagram</h3>
                <p class="chart-subtitle">Three-set Venn diagram with regions Iâ€“VII.</p>
                <div id="chart7"></div>
            </div>
            
            <!-- Chart 8: Cross Validation Accuracy Bars -->
            <div class="chart-card">
                <h3 class="chart-title">Chart 8 â€” Cross Validation Accuracy Bars</h3>
                <p class="chart-subtitle">Grouped bars with a solid accuracy bar and a dashed baseline bar for each model.</p>
                <div id="chart8"></div>
            </div>
            
            <!-- Chart 9: Sketch to SVG Figure -->
            <div class="chart-card">
                <h3 class="chart-title">Chart 9 â€” Sketch to SVG Figure</h3>
                <p class="chart-subtitle">Line-drawing style character sitting on a block.</p>
                <div id="chart9"></div>
            </div>
            
            <!-- Chart 10: Map with Highlighted Region -->
            <div class="chart-card">
                <h3 class="chart-title">Chart 10 â€” Map with Highlighted Region</h3>
                <p class="chart-subtitle">Abstract map with four land masses and a red focus ellipse.</p>
                <div id="chart10"></div>
            </div>
            
            <!-- Chart 11: Probability Density Functions -->
            <div class="chart-card">
                <h3 class="chart-title">Chart 11 â€” Probability Density Functions</h3>
                <p class="chart-subtitle">Two Gaussian curves with a shaded overlapping region and vertical reference lines.</p>
                <div id="chart11"></div>
            </div>
        </div>
    </section>

    <!-- A4: çƒ­åŠ›å›¾å¯è§†åŒ– -->
    <section class="assignment-module" id="a4">
        <div class="module-header">
            <div class="module-number">4</div>
            <div>
                <h2 class="module-title">Assignment 4: æœºå™¨å­¦ä¹ æ¨¡å‹é²æ£’æ€§çƒ­åŠ›å›¾</h2>
                <p class="module-description">å±•ç¤ºä¸åŒé˜²å¾¡æ–¹æ³•å¯¹å¯¹æŠ—æ”»å‡»çš„é²æ£’æ€§åˆ†æ</p>
            </div>
        </div>
        
        <div id="a4-content">
            <div class="analysis-section">
                <h3>ğŸ“ˆ å¯è§†åŒ–æ¦‚è¿°</h3>
                <p><strong>æ•°æ®èƒŒæ™¯ï¼š</strong>æ­¤çƒ­åŠ›å›¾å¯è§†åŒ–9ç§æœºå™¨å­¦ä¹ é˜²å¾¡æ–¹æ³•å¯¹26ç§ä¸åŒå¯¹æŠ—æ”»å‡»çš„é²æ£’æ€§ã€‚æ¯ä¸ªå•å…ƒæ ¼é¢œè‰²è¡¨ç¤ºåœ¨ç‰¹å®šæ”»å‡»åœºæ™¯ä¸‹æ¨¡å‹çš„åˆ†ç±»å‡†ç¡®ç‡ã€‚</p>
                
                <p><strong>äº¤äº’åŠŸèƒ½ï¼š</strong></p>
                <ul>
                    <li>ğŸ¯ <strong>é¼ æ ‡æ‚¬åœ</strong> - æŸ¥çœ‹ä»»ä½•å•å…ƒæ ¼çš„è¯¦ç»†æ•°æ®ï¼ˆæ”»å‡»æ–¹æ³•ã€é˜²å¾¡æ–¹æ³•ã€å‡†ç¡®ç‡ï¼‰</li>
                    <li>ğŸŒˆ <strong>é¢œè‰²è§£è¯»</strong> - çº¢è‰²ï¼ˆ0-30%ï¼‰è¡¨ç¤ºé˜²å¾¡è¾ƒå¼±ï¼Œé»„è‰²ï¼ˆ30-70%ï¼‰è¡¨ç¤ºä¸­ç­‰æ€§èƒ½ï¼Œç»¿è‰²ï¼ˆ70-100%ï¼‰è¡¨ç¤ºé˜²å¾¡è¾ƒå¼º</li>
                    <li>ğŸ“Š <strong>æ¨¡å¼è¯†åˆ«</strong> - è§‚å¯Ÿè¡Œ/åˆ—çš„é¢œè‰²è¶‹åŠ¿ï¼Œåˆ†æç‰¹å®šæ”»å‡»æˆ–é˜²å¾¡çš„æ•´ä½“æ•ˆæœ</li>
                </ul>
                
                <p><strong>ä¸»è¦å‘ç°ï¼š</strong></p>
                <ul>
                    <li>ğŸ›¡ï¸ <strong>æœ€ä½³é˜²å¾¡</strong> - TandTæ–¹æ³•åœ¨å¤§å¤šæ•°æ”»å‡»ä¸‹ä¿æŒé«˜å‡†ç¡®ç‡ï¼ˆç»¿è‰²å•å…ƒæ ¼æœ€å¤šï¼‰</li>
                    <li>âš”ï¸ <strong>æœ€å¼ºæ”»å‡»</strong> - MIFGSMã€APGDæ–¹æ³•èƒ½æœ‰æ•ˆé™ä½å¤§å¤šæ•°é˜²å¾¡çš„å‡†ç¡®ç‡</li>
                    <li>ğŸ¯ <strong>é’ˆå¯¹æ€§æ•ˆæœ</strong> - æŸäº›æ”»å‡»å¯¹ç‰¹å®šé˜²å¾¡ç‰¹åˆ«æœ‰æ•ˆï¼ˆä¾‹å¦‚Pixleæ”»å‡»å½±å“æ‰€æœ‰é˜²å¾¡ï¼‰</li>
                </ul>
            </div>
            
            <div class="heatmap-container">
                <div id="chart"></div>
            </div>
            
            <div class="heatmap-legend">
                <span><strong>ä½å‡†ç¡®ç‡ (0%)</strong></span>
                <div class="color-bar"></div>
                <span><strong>é«˜å‡†ç¡®ç‡ (100%)</strong></span>
            </div>
        </div>
    </section>

    <!-- é¡µè„š -->
    <footer style="text-align: center; margin-top: 40px; padding: 20px; color: #666; border-top: 1px solid #eee;">
        <p>Assignment 5 - æ•´åˆä½œä¸šå±•ç¤º | æ‰€æœ‰ä½œä¸šåŠŸèƒ½ä¿æŒå®Œæ•´è¿è¡Œ</p>
        <p>Â© 2023 æ•°æ®å¯è§†åŒ–è¯¾ç¨‹é¡¹ç›®</p>
    </footer>

    <!-- ==================== JavaScript ä»£ç  ==================== -->
    <script>
        // ==================== A1: ç©ºæ°”è´¨é‡API ====================
        (function() {
            const labels = {
                "o3_sub_index": "è‡­æ°§å­æŒ‡æ•° (Oâ‚ƒ)",
                "pm10_twenty_four_hourly": "PMâ‚â‚€ 24å°æ—¶å¹³å‡æµ“åº¦",
                "pm10_sub_index": "PMâ‚â‚€ å­æŒ‡æ•°",
                "co_sub_index": "ä¸€æ°§åŒ–ç¢³å­æŒ‡æ•° (CO)",
                "pm25_twenty_four_hourly": "PMâ‚‚.â‚… 24å°æ—¶å¹³å‡æµ“åº¦",
                "so2_sub_index": "äºŒæ°§åŒ–ç¡«å­æŒ‡æ•° (SOâ‚‚)",
                "co_eight_hour_max": "ä¸€æ°§åŒ–ç¢³8å°æ—¶æœ€å¤§å€¼",
                "no2_one_hour_max": "äºŒæ°§åŒ–æ°®1å°æ—¶æœ€å¤§å€¼ (NOâ‚‚)",
                "so2_twenty_four_hourly": "äºŒæ°§åŒ–ç¡«24å°æ—¶å¹³å‡æµ“åº¦",
                "pm25_sub_index": "PMâ‚‚.â‚… å­æŒ‡æ•°",
                "psi_twenty_four_hourly": "ç©ºæ°”æ±¡æŸ“æŒ‡æ•° (PSI)",
                "o3_eight_hour_max": "è‡­æ°§8å°æ—¶æœ€å¤§å€¼"
            };

            async function loadData() {
                try {
                    const res = await fetch("https://api.data.gov.sg/v1/environment/psi");
                    const json = await res.json();
                    const readings = json.items[0].readings;
                    const regions = Object.keys(readings.psi_twenty_four_hourly);
                    const tbody = document.querySelector("#data-table tbody");
                    const update = document.getElementById("update");
                    const time = new Date(json.items[0].update_timestamp).toLocaleString("zh-SG", { 
                        timeZone: "Asia/Singapore" 
                    });
                    update.textContent = `æœ€åæ›´æ–°ï¼š${time}`;
                    tbody.innerHTML = "";
                    
                    for (const key in readings) {
                        const row = document.createElement("tr");
                        const label = labels[key] || key;
                        row.innerHTML = `<td>${label}</td>` + 
                            regions.map(r => `<td>${readings[key][r]}</td>`).join("");
                        tbody.appendChild(row);
                    }
                } catch (error) {
                    console.error("åŠ è½½æ•°æ®å¤±è´¥:", error);
                    document.getElementById("update").textContent = "æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•";
                }
            }

            // åˆå§‹åŒ– & æ¯åˆ†é’Ÿåˆ·æ–°
            loadData();
            setInterval(loadData, 60000);
        })();

        // ==================== A2: SVGå˜æ¢è¡¨æ ¼ ====================
        (function() {
            const svgFiles = ['one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten'];
            const tableBody = document.getElementById('svg-table-body');
            
            svgFiles.forEach(fileName => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="svg-cell">
                        <div class="svg-frame">
                            <img src="${fileName}.svg" alt="original ${fileName}.svg">
                        </div>
                    </td>
                    <td class="svg-cell">
                        <div class="svg-frame mirror">
                            <img src="${fileName}.svg" alt="mirror ${fileName}.svg">
                        </div>
                    </td>
                    <td class="svg-cell">
                        <div class="svg-frame rotate180">
                            <img src="${fileName}.svg" alt="rotate180 ${fileName}.svg">
                        </div>
                    </td>
                    <td class="svg-cell">
                        <div class="svg-frame squeezeY">
                            <img src="${fileName}.svg" alt="squeezeY ${fileName}.svg">
                        </div>
                    </td>
                    <td class="svg-cell">
                        <div class="svg-frame grayscale">
                            <img src="${fileName}.svg" alt="grayscale ${fileName}.svg">
                        </div>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        })();

        // ==================== A3: D3å¯è§†åŒ– ====================
        (function() {
            // å…±äº«tooltipï¼ˆç”¨äºæŸ±çŠ¶å›¾ï¼‰
            const tooltip = d3.select("body")
                .append("div")
                .attr("class", "tooltip")
                .style("opacity", 0);

            // Chart 7: Venn diagram
            function drawChart7() {
                const width = 420;
                const height = 260;
                const svg = d3.select("#chart7")
                    .append("svg")
                    .attr("width", width)
                    .attr("height", height);

                const g = svg.append("g")
                    .attr("transform", "translate(0,10)");

                const circles = [
                    { id: "A", cx: 150, cy: 120, r: 80, color: "#c4b5fd", label: "Delete" },
                    { id: "B", cx: 220, cy: 80, r: 80, color: "#bfdbfe", label: "Replace" },
                    { id: "C", cx: 260, cy: 140, r: 80, color: "#fde68a", label: "Rewrite" }
                ];

                const circleSelection = g.selectAll("circle.venn")
                    .data(circles)
                    .enter()
                    .append("circle")
                    .attr("class", "venn")
                    .attr("cx", d => d.cx)
                    .attr("cy", d => d.cy)
                    .attr("r", 0)
                    .attr("fill", d => d.color)
                    .attr("fill-opacity", 0.2)
                    .attr("stroke", "#4b5563")
                    .attr("stroke-width", 1)
                    .on("mouseover", function(event, d) {
                        d3.select(this)
                            .transition().duration(200)
                            .attr("r", d.r + 6)
                            .attr("fill-opacity", 0.8);
                    })
                    .on("mouseout", function(event, d) {
                        d3.select(this)
                            .transition().duration(200)
                            .attr("r", d.r)
                            .attr("fill-opacity", 0.55);
                    });

                // åŠ è½½æ—¶åœ†åœˆåŠ¨ç”»
                circleSelection
                    .transition()
                    .duration(800)
                    .attr("r", d => d.r)
                    .attr("fill-opacity", 0.55);

                const labels = [
                    { text: "I", x: 90, y: 140 },
                    { text: "II", x: 220, y: 30 },
                    { text: "III", x: 330, y: 145 },
                    { text: "IV", x: 165, y: 115 },
                    { text: "V", x: 235, y: 110 },
                    { text: "VI", x: 205, y: 150 },
                    { text: "VII", x: 220, y: 130 }
                ];

                g.selectAll("text.region")
                    .data(labels)
                    .enter()
                    .append("text")
                    .attr("class", "region")
                    .attr("x", d => d.x)
                    .attr("y", d => d.y)
                    .attr("text-anchor", "middle")
                    .attr("dominant-baseline", "central")
                    .style("font-size", "13px")
                    .style("fill", "#111827")
                    .style("opacity", 0)
                    .transition()
                    .delay(700)
                    .duration(500)
                    .style("opacity", 1)
                    .text(d => d.text);

                g.append("text")
                    .attr("x", 70)
                    .attr("y", 30)
                    .style("font-size", "12px")
                    .style("opacity", 0)
                    .text("Delete")
                    .transition().delay(700).duration(500).style("opacity", 1);

                g.append("text")
                    .attr("x", 210)
                    .attr("y", 20)
                    .style("font-size", "12px")
                    .style("opacity", 0)
                    .text("Replace")
                    .transition().delay(700).duration(500).style("opacity", 1);

                g.append("text")
                    .attr("x", 330)
                    .attr("y", 40)
                    .style("font-size", "12px")
                    .style("opacity", 0)
                    .text("Rewrite")
                    .transition().delay(700).duration(500).style("opacity", 1);
            }

            // Chart 8: Simple bars
            function drawChart8() {
                const data = [
                    { model: "BERT", base: 74.4, dashed: 64.8 },
                    { model: "RoBERTa", base: 81.9, dashed: 65.5 },
                    { model: "BART", base: 73.1, dashed: 63.5 }
                ];

                const margin = { top: 40, right: 20, bottom: 40, left: 40 };
                const width = 420 - margin.left - margin.right;
                const height = 240 - margin.top - margin.bottom;

                const svg = d3.select("#chart8")
                    .append("svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", `translate(${margin.left},${margin.top})`);

                const x = d3.scaleBand()
                    .domain(data.map(d => d.model))
                    .range([0, width])
                    .padding(0.4);

                const y = d3.scaleLinear()
                    .domain([0, 100])
                    .nice()
                    .range([height, 0]);

                svg.append("g")
                    .attr("transform", `translate(0,${height})`)
                    .call(d3.axisBottom(x));

                svg.append("g")
                    .call(d3.axisLeft(y).ticks(5));

                svg.append("line")
                    .attr("x1", 0)
                    .attr("x2", width)
                    .attr("y1", height)
                    .attr("y2", height)
                    .attr("stroke", "#111827")
                    .attr("stroke-width", 1);

                const bars = svg.selectAll(".bar-base")
                    .data(data)
                    .enter()
                    .append("rect")
                    .attr("class", "bar-base")
                    .attr("x", d => x(d.model))
                    .attr("width", x.bandwidth())
                    .attr("y", height)
                    .attr("height", 0)
                    .attr("fill", "#f9e4a4")
                    .attr("stroke", "#b38f3b")
                    .attr("stroke-width", 0.8)
                    .on("mouseover", function(event, d) {
                        d3.select(this)
                            .transition().duration(200)
                            .attr("y", y(d.base) - 5)
                            .attr("height", height - y(d.base) + 5)
                            .attr("fill", "#fde68a");
                        tooltip
                            .style("opacity", 1)
                            .html(`<strong>${d.model}</strong><br/>Accuracy: ${d.base}%`)
                            .style("left", (event.pageX + 10) + "px")
                            .style("top", (event.pageY - 28) + "px");
                    })
                    .on("mouseout", function(event, d) {
                        d3.select(this)
                            .transition().duration(200)
                            .attr("y", y(d.base))
                            .attr("height", height - y(d.base))
                            .attr("fill", "#f9e4a4");
                        tooltip.style("opacity", 0);
                    });

                // åŠ è½½åŠ¨ç”»
                bars.transition()
                    .delay((d, i) => i * 200)
                    .duration(800)
                    .attr("y", d => y(d.base))
                    .attr("height", d => height - y(d.base));

                svg.selectAll(".bar-dashed")
                    .data(data)
                    .enter()
                    .append("rect")
                    .attr("class", "bar-dashed")
                    .attr("x", d => x(d.model) + x.bandwidth() * 0.1)
                    .attr("width", x.bandwidth() * 0.8)
                    .attr("y", d => y(d.dashed))
                    .attr("height", d => height - y(d.dashed))
                    .attr("fill", "none")
                    .attr("stroke", "#d4b866")
                    .attr("stroke-dasharray", "4,3")
                    .attr("stroke-width", 1.2)
                    .style("opacity", 0)
                    .transition()
                    .delay(700)
                    .duration(500)
                    .style("opacity", 1);

                svg.selectAll(".label-base")
                    .data(data)
                    .enter()
                    .append("text")
                    .attr("class", "label-base")
                    .attr("x", d => x(d.model) + x.bandwidth() / 2)
                    .attr("y", d => y(d.base) - 6)
                    .attr("text-anchor", "middle")
                    .style("font-size", "11px")
                    .style("opacity", 0)
                    .text(d => d.base.toFixed(1))
                    .transition()
                    .delay(700)
                    .duration(500)
                    .style("opacity", 1);

                svg.selectAll(".label-dashed")
                    .data(data)
                    .enter()
                    .append("text")
                    .attr("class", "label-dashed")
                    .attr("x", d => x(d.model) + x.bandwidth() / 2)
                    .attr("y", d => y(d.dashed) + 12)
                    .attr("text-anchor", "middle")
                    .style("font-size", "10px")
                    .style("fill", "#6b7280")
                    .style("opacity", 0)
                    .text(d => d.dashed.toFixed(1))
                    .transition()
                    .delay(700)
                    .duration(500)
                    .style("opacity", 1);

                svg.append("text")
                    .attr("x", width / 2)
                    .attr("y", -15)
                    .attr("text-anchor", "middle")
                    .style("font-size", "13px")
                    .style("font-weight", "bold")
                    .text("Cross Validation Accuracy (%)");
            }

            // Chart 9: Sketch to SVG
            function drawChart9() {
                const width = 360;
                const height = 220;
                const svg = d3.select("#chart9")
                    .append("svg")
                    .attr("width", width)
                    .attr("height", height)
                    .style("background", "#f9fafb");

                const g = svg.append("g")
                    .attr("transform", "translate(40,15)")
                    .attr("stroke", "#4b5563")
                    .attr("fill", "none")
                    .attr("stroke-linecap", "round")
                    .attr("stroke-linejoin", "round")
                    .style("opacity", 0);

                // æ–¹å—
                g.append("rect")
                    .attr("x", 30)
                    .attr("y", 110)
                    .attr("width", 220)
                    .attr("height", 40)
                    .attr("fill", "#e5e7eb")
                    .attr("stroke-width", 1.2);

                // èº«ä½“
                g.append("line").attr("x1", 140).attr("y1", 80).attr("x2", 140).attr("y2", 120).attr("stroke-width", 1.5);
                
                // å¤´éƒ¨
                g.append("rect")
                    .attr("x", 115)
                    .attr("y", 30)
                    .attr("width", 50)
                    .attr("height", 40)
                    .attr("fill", "#f3f4f6")
                    .attr("stroke-width", 1.5);

                // è„¸éƒ¨
                g.append("line").attr("x1", 125).attr("y1", 48).attr("x2", 135).attr("y2", 48);
                g.append("line").attr("x1", 146).attr("y1", 48).attr("x2", 156).attr("y2", 48);
                g.append("line").attr("x1", 130).attr("y1", 58).attr("x2", 150).attr("y2", 58);

                // è…¿
                g.append("line").attr("x1", 140).attr("y1", 120).attr("x2", 120).attr("y2", 150);
                g.append("line").attr("x1", 120).attr("y1", 150).attr("x2", 115).attr("y2", 165);
                g.append("line").attr("x1", 140).attr("y1", 120).attr("x2", 155).attr("y2", 150);
                g.append("line").attr("x1", 155).attr("y1", 150).attr("x2", 160).attr("y2", 165);

                // æ‰‹è‡‚å’Œæ£å­
                g.append("line").attr("x1", 140).attr("y1", 90).attr("x2", 110).attr("y2", 110);
                g.append("line").attr("x1", 140).attr("y1", 90).attr("x2", 170).attr("y2", 105);
                g.append("line").attr("x1", 105).attr("y1", 108).attr("x2", 185).attr("y2", 130);

                // æ‰‹éƒ¨åœ†åœˆ
                g.append("circle").attr("cx", 110).attr("cy", 110).attr("r", 3).attr("fill", "#4b5563");
                g.append("circle").attr("cx", 170).attr("cy", 105).attr("r", 3).attr("fill", "#4b5563");

                // æ·¡å…¥åŠ¨ç”»
                g.transition()
                    .duration(800)
                    .style("opacity", 1);

                // æ‚¬åœæ•ˆæœï¼šçº¿æ¡å®½åº¦å˜åŒ–
                g.on("mouseover", function() {
                    d3.select(this).transition().duration(150).attr("stroke-width", 2);
                })
                .on("mouseout", function() {
                    d3.select(this).transition().duration(150).attr("stroke-width", 1.2);
                });
            }

            // Chart 10: Map
            function drawChart10() {
                const width = 360;
                const height = 260;
                const svg = d3.select("#chart10")
                    .append("svg")
                    .attr("width", width)
                    .attr("height", height)
                    .style("background", "#f9fafb");

                const margin = { top: 20, right: 20, bottom: 20, left: 20 };
                const innerWidth = width - margin.left - margin.right;
                const innerHeight = height - margin.top - margin.bottom;

                const g = svg.append("g")
                    .attr("transform", `translate(${margin.left},${margin.top}) scale(0.8)`)
                    .style("opacity", 0.2);

                // ç½‘æ ¼
                const step = 24;
                for (let x = 0; x <= innerWidth; x += step) {
                    g.append("line")
                        .attr("x1", x)
                        .attr("y1", 0)
                        .attr("x2", x)
                        .attr("y2", innerHeight)
                        .attr("stroke", "#e5e7eb")
                        .attr("stroke-width", 0.6);
                }
                for (let y = 0; y <= innerHeight; y += step) {
                    g.append("line")
                        .attr("x1", 0)
                        .attr("y1", y)
                        .attr("x2", innerWidth)
                        .attr("y2", y)
                        .attr("stroke", "#e5e7eb")
                        .attr("stroke-width", 0.6);
                }

                // é™†åœ°å¤šè¾¹å½¢
                const land = [
                    [[40, 40],[110, 35],[140, 60],[120, 110],[60, 100]],
                    [[170, 50],[240, 45],[260, 80],[230, 110],[185, 95]],
                    [[70, 150],[120, 145],[150, 175],[130, 210],[80, 200]],
                    [[190, 150],[250, 160],[260, 195],[220, 210],[190, 190]]
                ];

                g.selectAll("polygon.land")
                    .data(land)
                    .enter()
                    .append("polygon")
                    .attr("class", "land")
                    .attr("points", d => d.map(p => p.join(",")).join(" "))
                    .attr("fill", "#f4d7a4")
                    .attr("stroke", "#d1a65a")
                    .attr("stroke-width", 0.8)
                    .on("mouseover", function() {
                        d3.select(this)
                            .transition().duration(200)
                            .attr("fill", "#fde7b4");
                    })
                    .on("mouseout", function() {
                        d3.select(this)
                            .transition().duration(200)
                            .attr("fill", "#f4d7a4");
                    });

                // ç„¦ç‚¹æ¤­åœ†
                g.append("ellipse")
                    .attr("cx", innerWidth * 0.55)
                    .attr("cy", innerHeight * 0.45)
                    .attr("rx", 90)
                    .attr("ry", 70)
                    .attr("fill", "none")
                    .attr("stroke", "#dc2626")
                    .attr("stroke-width", 2);

                // ç¼©æ”¾ + æ·¡å…¥åŠ¨ç”»
                g.transition()
                    .duration(900)
                    .attr("transform", `translate(${margin.left},${margin.top}) scale(1)`)
                    .style("opacity", 1);

                svg.append("text")
                    .attr("x", width / 2)
                    .attr("y", 16)
                    .attr("text-anchor", "middle")
                    .style("font-size", "12px")
                    .text("Abstract Map with Focus Region");
            }

            // Chart 11: Functions
            function drawChart11() {
                const margin = { top: 30, right: 20, bottom: 40, left: 45 };
                const width = 420 - margin.left - margin.right;
                const height = 260 - margin.top - margin.bottom;

                const svg = d3.select("#chart11")
                    .append("svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", `translate(${margin.left},${margin.top})`);

                const x = d3.scaleLinear()
                    .domain([-2, 5])
                    .range([0, width]);

                const y = d3.scaleLinear()
                    .domain([0, 0.35])
                    .range([height, 0]);

                svg.append("g")
                    .attr("transform", `translate(0,${height})`)
                    .call(d3.axisBottom(x).ticks(7));

                svg.append("g")
                    .call(d3.axisLeft(y).ticks(5));

                svg.append("text")
                    .attr("x", width / 2)
                    .attr("y", height + 32)
                    .attr("text-anchor", "middle")
                    .style("font-size", "12px")
                    .text("x");

                svg.append("text")
                    .attr("transform", "rotate(-90)")
                    .attr("x", -height / 2)
                    .attr("y", -32)
                    .attr("text-anchor", "middle")
                    .style("font-size", "12px")
                    .text("Probability Density");

                // é«˜æ–¯å‡½æ•°
                function gaussian(xVal, mu, sigma) {
                    const coeff = 1 / (Math.sqrt(2 * Math.PI) * sigma);
                    const expo = -Math.pow(xVal - mu, 2) / (2 * sigma * sigma);
                    return coeff * Math.exp(expo);
                }

                const xs = d3.range(-2, 5.01, 0.05);
                const data0 = xs.map(d => ({ x: d, y: gaussian(d, 0.2, 0.9) }));
                const data1 = xs.map(d => ({ x: d, y: gaussian(d, 1.8, 0.8) }));

                const lineGen = d3.line()
                    .x(d => x(d.x))
                    .y(d => y(d.y));

                // é‡å åŒºåŸŸ
                const overlap = xs.map(d => {
                    const y0 = gaussian(d, 0.2, 0.9);
                    const y1 = gaussian(d, 1.8, 0.8);
                    return { x: d, y: Math.min(y0, y1) };
                });

                const areaOverlap = d3.area()
                    .x(d => x(d.x))
                    .y0(y(0))
                    .y1(d => y(d.y));

                const overlapPath = svg.append("path")
                    .datum(overlap)
                    .attr("fill", "#9ca3af")
                    .attr("opacity", 0)
                    .attr("d", areaOverlap);

                overlapPath
                    .transition()
                    .duration(700)
                    .attr("opacity", 0.5);

                // ç¬¬ä¸€æ¡æ›²çº¿
                const path0 = svg.append("path")
                    .datum(data0)
                    .attr("fill", "none")
                    .attr("stroke", "#f59e0b")
                    .attr("stroke-width", 2)
                    .attr("d", lineGen)
                    .on("mouseover", function() {
                        d3.select(this).transition().duration(150).attr("stroke-width", 3);
                    })
                    .on("mouseout", function() {
                        d3.select(this).transition().duration(150).attr("stroke-width", 2);
                    });

                const length0 = path0.node().getTotalLength();
                path0
                    .attr("stroke-dasharray", length0 + " " + length0)
                    .attr("stroke-dashoffset", length0)
                    .transition()
                    .delay(400)
                    .duration(900)
                    .attr("stroke-dashoffset", 0);

                // ç¬¬äºŒæ¡æ›²çº¿
                const path1 = svg.append("path")
                    .datum(data1)
                    .attr("fill", "none")
                    .attr("stroke", "#0ea5e9")
                    .attr("stroke-width", 2)
                    .attr("d", lineGen)
                    .on("mouseover", function() {
                        d3.select(this).transition().duration(150).attr("stroke-width", 3);
                    })
                    .on("mouseout", function() {
                        d3.select(this).transition().duration(150).attr("stroke-width", 2);
                    });

                const length1 = path1.node().getTotalLength();
                path1
                    .attr("stroke-dasharray", length1 + " " + length1)
                    .attr("stroke-dashoffset", length1)
                    .transition()
                    .delay(700)
                    .duration(900)
                    .attr("stroke-dashoffset", 0);

                // é‡å åŒºåŸŸæ‚¬åœæ•ˆæœ
                overlapPath
                    .on("mouseover", function() {
                        d3.select(this).transition().duration(150).attr("opacity", 0.8);
                    })
                    .on("mouseout", function() {
                        d3.select(this).transition().duration(150).attr("opacity", 0.5);
                    });

                // å‚ç›´å‚è€ƒçº¿
                const vlines = [0, 1, 2];
                svg.selectAll(".vline")
                    .data(vlines)
                    .enter()
                    .append("line")
                    .attr("class", "vline")
                    .attr("x1", d => x(d))
                    .attr("x2", d => x(d))
                    .attr("y1", height)
                    .attr("y2", 0)
                    .attr("stroke", "#6b7280")
                    .attr("stroke-dasharray", "4,3")
                    .attr("stroke-width", 1);

                // å›¾ä¾‹
                const legend = svg.append("g")
                    .attr("transform", `translate(${width - 160}, 10)`);

                legend.append("line")
                    .attr("x1", 0).attr("y1", 0)
                    .attr("x2", 26).attr("y2", 0)
                    .attr("stroke", "#f59e0b")
                    .attr("stroke-width", 2);

                legend.append("text")
                    .attr("x", 32).attr("y", 3)
                    .style("font-size", "11px")
                    .text("p(x, y = 0) * v(x)");

                legend.append("line")
                    .attr("x1", 0).attr("y1", 16)
                    .attr("x2", 26).attr("y2", 16)
                    .attr("stroke", "#0ea5e9")
                    .attr("stroke-width", 2);

                legend.append("text")
                    .attr("x", 32).attr("y", 19)
                    .style("font-size", "11px")
                    .text("p(x, y = 1) * v(x)");
            }

            // ç»˜åˆ¶æ‰€æœ‰å›¾è¡¨
            drawChart7();
            drawChart8();
            drawChart9();
            drawChart10();
            drawChart11();
        })();

        // ==================== A4: çƒ­åŠ›å›¾ ====================
        (function() {
            // æ•°æ®
            const data = {
                "No Attack": {"ERM": 94.85, "DA": 94.21, "PGDT": 84.38, "TRADES": 80.42, "MART": 81.54, "RS": 89.45, "IBP": 48.4, "PRL": 93.82, "TandT": 94.23},
                "TIFGSM": {"ERM": 35.1, "DA": 33.0, "PGDT": 65.7, "TRADES": 62.9, "MART": 69.1, "RS": 45.4, "IBP": 40.2, "PRL": 34.0, "TandT": 92.8},
                "MIFGSM": {"ERM": 0.0, "DA": 0.0, "PGDT": 50.9, "TRADES": 51.9, "MART": 50.5, "RS": 5.8, "IBP": 38.1, "PRL": 0.0, "TandT": 92.8},
                "DIFGSM": {"ERM": 1.0, "DA": 0.0, "PGDT": 51.75, "TRADES": 50.5, "MART": 53.6, "RS": 4.1, "IBP": 38.1, "PRL": 3.1, "TandT": 92.8},
                "VMIFGSM": {"ERM": 0.0, "DA": 0.0, "PGDT": 51.1, "TRADES": 50.9, "MART": 51.9, "RS": 4.1, "IBP": 38.1, "PRL": 0.0, "TandT": 93.9},
                "TPGD": {"ERM": 38.1, "DA": 39.2, "PGDT": 69.3, "TRADES": 69.1, "MART": 70.1, "RS": 48.5, "IBP": 50.0, "PRL": 28.9, "TandT": 91.8},
                "FGSM": {"ERM": 29.9, "DA": 25.8, "PGDT": 57.95, "TRADES": 54.6, "MART": 61.9, "RS": 28.9, "IBP": 38.1, "PRL": 25.8, "TandT": 93.8},
                "RFGSM": {"ERM": 0.0, "DA": 0.0, "PGDT": 49.15, "TRADES": 50.4, "MART": 48.5, "RS": 3.7, "IBP": 38.1, "PRL": 0.0, "TandT": 90.0},
                "BIM": {"ERM": 0.0, "DA": 0.0, "PGDT": 52.0, "TRADES": 57.2, "MART": 47.4, "RS": 2.1, "IBP": 38.1, "PRL": 0.0, "TandT": 90.7},
                "FAB": {"ERM": 1.0, "DA": 2.1, "PGDT": 43.0, "TRADES": 46.4, "MART": 40.2, "RS": 5.3, "IBP": 38.1, "PRL": 4.1, "TandT": 90.1},
                "CW": {"ERM": 0.0, "DA": 0.0, "PGDT": 32.2, "TRADES": 35.1, "MART": 29.9, "RS": 1.0, "IBP": 40.2, "PRL": 1.0, "TandT": 92.9},
                "UPGD": {"ERM": 0.0, "DA": 0.0, "PGDT": 49.85, "TRADES": 50.5, "MART": 49.8, "RS": 5.1, "IBP": 38.1, "PRL": 0.0, "TandT": 93.8},
                "FFGSM": {"ERM": 19.6, "DA": 23.7, "PGDT": 60.55, "TRADES": 55.7, "MART": 66.0, "RS": 33.0, "IBP": 42.3, "PRL": 29.9, "TandT": 92.8},
                "Jitter": {"ERM": 11.3, "DA": 12.4, "PGDT": 48.15, "TRADES": 47.4, "MART": 49.5, "RS": 34.0, "IBP": 39.2, "PRL": 24.7, "TandT": 90.7},
                "PGD": {"ERM": 0.0, "DA": 0.0, "PGDT": 57.4, "TRADES": 54.6, "MART": 60.8, "RS": 7.2, "IBP": 40.2, "PRL": 0.0, "TandT": 91.8},
                "EOTPGD": {"ERM": 0.0, "DA": 0.0, "PGDT": 50.1, "TRADES": 50.3, "MART": 50.5, "RS": 3.0, "IBP": 38.1, "PRL": 0.0, "TandT": 90.7},
                "APGD": {"ERM": 0.0, "DA": 0.0, "PGDT": 48.4, "TRADES": 51.0, "MART": 46.4, "RS": 1.0, "IBP": 38.1, "PRL": 0.0, "TandT": 90.7},
                "NIFGSM": {"ERM": 0.0, "DA": 0.0, "PGDT": 57.95, "TRADES": 56.7, "MART": 59.8, "RS": 7.2, "IBP": 38.1, "PRL": 1.0, "TandT": 92.8},
                "SiniFGSM": {"ERM": 4.1, "DA": 1.0, "PGDT": 59.0, "TRADES": 56.7, "MART": 61.9, "RS": 23.7, "IBP": 38.1, "PRL": 12.4, "TandT": 93.7},
                "VNIFGSM": {"ERM": 0.0, "DA": 0.0, "PGDT": 50.45, "TRADES": 53.0, "MART": 48.5, "RS": 5.1, "IBP": 38.1, "PRL": 0.0, "TandT": 92.9},
                "APGDT": {"ERM": 0.0, "DA": 0.0, "PGDT": 40.9, "TRADES": 44.3, "MART": 38.1, "RS": 0.0, "IBP": 38.1, "PRL": 0.0, "TandT": 88.7},
                "Square": {"ERM": 0.0, "DA": 1.0, "PGDT": 50.4, "TRADES": 54.0, "MART": 47.4, "RS": 3.1, "IBP": 38.1, "PRL": 2.1, "TandT": 88.08},
                "Add Gaussian Noise": {"ERM": 25.8, "DA": 43.3, "PGDT": 79.1, "TRADES": 78.4, "MART": 80.4, "RS": 74.2, "IBP": 42.3, "PRL": 45.4, "TandT": 87.6},
                "OnePixel": {"ERM": 79.4, "DA": 83.5, "PGDT": 78.05, "TRADES": 74.2, "MART": 82.5, "RS": 83.5, "IBP": 42.5, "PRL": 80.4, "TandT": 89.7},
                "Pixle": {"ERM": 0.0, "DA": 0.0, "PGDT": 12.55, "TRADES": 11.3, "MART": 14.4, "RS": 1.0, "IBP": 10.3, "PRL": 0.0, "TandT": 17.5},
                "PGDL2": {"ERM": 1.0, "DA": 0.0, "PGDT": 35.8, "TRADES": 36.1, "MART": 36.1, "RS": 5.2, "IBP": 36.1, "PRL": 0.0, "TandT": 92.9}
            };

            // åˆ›å»ºå›¾è¡¨ - æ°´å¹³å¸ƒå±€
            const margin = { top: 50, right: 30, bottom: 100, left: 120 };
            const width = 1100 - margin.left - margin.right;
            const height = 600 - margin.top - margin.bottom;

            const svg = d3.select("#chart")
                .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);

            const colorScale = d3.scaleLinear()
                .range(["#e74c3c", "#f1c40f", "#27ae60"])
                .domain([0, 50, 100]);

            // é˜²å¾¡æ–¹æ³•åœ¨Xè½´ï¼Œæ”»å‡»æ–¹æ³•åœ¨Yè½´
            const xScale = d3.scaleBand()
                .range([0, width])
                .padding(0.05);

            const yScale = d3.scaleBand()
                .range([0, height])
                .padding(0.05);

            // å¤„ç†æ•°æ®
            const defenseMethods = Object.keys(data["No Attack"]);
            const attackMethods = Object.keys(data);

            xScale.domain(defenseMethods);
            yScale.domain(attackMethods);

            // ç»˜åˆ¶Yè½´ï¼ˆæ”»å‡»æ–¹æ³•ï¼‰
            svg.append("g")
                .call(d3.axisLeft(yScale))
                .selectAll("text")
                .style("font-size", "10px");

            // ç»˜åˆ¶Xè½´ï¼ˆé˜²å¾¡æ–¹æ³•ï¼‰
            svg.append("g")
                .attr("transform", `translate(0, ${height})`)
                .call(d3.axisBottom(xScale))
                .selectAll("text")
                .attr("transform", "rotate(-45)")
                .style("text-anchor", "end")
                .style("font-size", "10px")
                .attr("dx", "-0.8em")
                .attr("dy", "0.15em");

            // ç»˜åˆ¶çƒ­åŠ›å›¾å•å…ƒæ ¼
            attackMethods.forEach(attack => {
                defenseMethods.forEach(defense => {
                    const value = data[attack][defense];
                    
                    svg.append("rect")
                        .attr("class", "cell")
                        .attr("x", xScale(defense))
                        .attr("y", yScale(attack))
                        .attr("width", xScale.bandwidth())
                        .attr("height", yScale.bandwidth())
                        .style("fill", colorScale(value))
                        .style("stroke", "#fff")
                        .style("stroke-width", 1)
                        .on("mouseover", function(event) {
                            d3.select(this)
                                .style("stroke", "#2c3e50")
                                .style("stroke-width", 2);
                            
                            const tooltip = d3.select("body").append("div")
                                .style("position", "absolute")
                                .style("background", "rgba(44, 62, 80, 0.95)")
                                .style("color", "white")
                                .style("padding", "10px")
                                .style("border-radius", "5px")
                                .style("font-size", "12px")
                                .style("left", (event.pageX + 10) + "px")
                                .style("top", (event.pageY - 40) + "px")
                                .html(`
                                    <div style="margin-bottom: 5px;"><strong>Attack Method:</strong> ${attack}</div>
                                    <div style="margin-bottom: 5px;"><strong>Defense Method:</strong> ${defense}</div>
                                    <div><strong>Accuracy:</strong> ${value}%</div>
                                `);
                        })
                        .on("mouseout", function() {
                            d3.select(this)
                                .style("stroke", "#fff")
                                .style("stroke-width", 1);
                            d3.selectAll("div").filter(function() {
                                return this.style.position === 'absolute';
                            }).remove();
                        });
                });
            });

            // æ·»åŠ è½´æ ‡ç­¾
            svg.append("text")
                .attr("transform", "rotate(-90)")
                .attr("y", 0 - margin.left + 20)
                .attr("x", 0 - (height / 2))
                .attr("dy", "1em")
                .style("text-anchor", "middle")
                .text("Attack Methods");

            svg.append("text")
                .attr("transform", `translate(${width / 2}, ${height + margin.bottom - 20})`)
                .style("text-anchor", "middle")
                .text("Defense Methods");
        })();
    </script>
</body>
</html>
