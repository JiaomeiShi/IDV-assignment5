<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assignment 5 - Integrated Assignment Showcase</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        /* ==================== Global Styles ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: #f5f7fa;
            color: #333;
            line-height: 1.6;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            overflow-x: hidden;
        }
        
        /* ==================== Top Navigation and Overview ==================== */
        .overview-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .overview-section h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .overview-content {
            background: rgba(255,255,255,0.1);
            padding: 25px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .overview-content h3 {
            color: #ffde59;
            margin-bottom: 15px;
        }
        
        .overview-content p {
            margin-bottom: 12px;
        }
        
        .overview-content ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        .overview-content li {
            margin-bottom: 5px;
        }
        
        /* ==================== Assignment Module Uniform Styles ==================== */
        .assignment-module {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            transition: transform 0.3s ease;
        }
        
        .assignment-module:hover {
            transform: translateY(-5px);
        }
        
        .module-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid;
        }
        
        .module-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 1.5em;
            font-weight: bold;
            border-radius: 50%;
            margin-right: 20px;
        }
        
        .module-title {
            font-size: 1.8em;
            color: #2c3e50;
            margin: 0;
        }
        
        .module-description {
            color: #666;
            font-size: 1.1em;
            margin-top: 5px;
        }
        
        /* ==================== A1 Specific Styles ==================== */
        #a1 .module-header {
            border-bottom-color: #3498db;
        }
        
        #a1 .module-number {
            background: #3498db;
        }
        
        .api-table {
            width: 100%;
            border-collapse: collapse;
            background: #1d2a4a;
            border-radius: 8px;
            overflow: hidden;
            margin-top: 20px;
        }
        
        .api-table th, .api-table td {
            border: 1px solid #333;
            padding: 12px;
            text-align: center;
            color: white;
        }
        
        .api-table th {
            background: #2e3b5a;
            color: white;
            font-weight: bold;
        }
        
        .api-table tr:hover {
            background: #2f3c60;
        }
        
        .api-update {
            text-align: center;
            margin: 20px 0 15px 0;
            color: #666;
            font-style: italic;
            font-size: 1.1em;
        }
        
        /* ==================== A2 Specific Styles ==================== */
        #a2 .module-header {
            border-bottom-color: #e74c3c;
        }
        
        #a2 .module-number {
            background: #e74c3c;
        }
        
        .svg-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            table-layout: fixed;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .svg-table th, .svg-table td {
            border: 1px solid #ddd;
            text-align: center;
            padding: 0;
        }
        
        .svg-table th {
            background-color: #c27ba0;
            font-size: 1.2em;
            border: 2px solid #ddd;
            height: 60px;
            color: white;
        }
        
        .svg-cell {
            height: 120px;
        }
        
        .svg-frame {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            background: #ffffff;
        }
        
        .svg-frame img {
            max-width: 60%;
            max-height: 60%;
            display: block;
            will-change: transform, filter;
            transform-origin: center center;
            image-rendering: auto;
        }
        
        .mirror img {
            transform: scaleX(-1);
        }
        
        .rotate180 img {
            transform: rotate(180deg);
        }
        
        .squeezeY img {
            transform: scaleY(0.5);
        }
        
        .grayscale img {
            filter: grayscale(100%);
        }
        
        /* ==================== A3 Specific Styles ==================== */
        #a3 .module-header {
            border-bottom-color: #2ecc71;
        }
        
        #a3 .module-number {
            background: #2ecc71;
        }
        
        .chart-container {
            margin-top: 20px;
        }
        
        .chart-card {
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.06);
            padding: 20px;
            margin-bottom: 28px;
        }
        
        .chart-title {
            margin: 0 0 4px;
            color: #2c3e50;
        }
        
        .chart-subtitle {
            margin: 0 0 16px;
            color: #6b7280;
            font-size: 0.9rem;
        }
        
        .chart-note {
            margin-top: 12px;
            padding-top: 8px;
            border-top: 1px dashed #e5e7eb;
            font-size: 0.9rem;
            color: #374151;
            line-height: 1.5;
        }
        
        .chart-note strong {
            color: #111827;
        }
        
        .tooltip {
            position: absolute;
            background: rgba(17,24,39,0.95);
            color: #f9fafb;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 12px;
            pointer-events: none;
            line-height: 1.4;
        }
        
        /* ==================== A4 Specific Styles ==================== */
        #a4 .module-header {
            border-bottom-color: #f39c12;
        }
        
        #a4 .module-number {
            background: #f39c12;
        }
        
        .heatmap-container {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        
        .heatmap-legend {
            margin-top: 20px;
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .color-bar {
            display: inline-block;
            width: 250px;
            height: 20px;
            background: linear-gradient(to right, #e74c3c, #f1c40f, #27ae60);
            margin: 0 10px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        
        /* ==================== Responsive Design ==================== */
        @media (max-width: 1200px) {
            .svg-cell {
                height: 100px;
            }
            
            .heatmap-container {
                overflow-x: auto;
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .overview-section {
                padding: 20px;
            }
            
            .overview-section h1 {
                font-size: 1.8em;
            }
            
            .assignment-module {
                padding: 20px;
            }
            
            .module-header {
                flex-direction: column;
                text-align: center;
            }
            
            .module-number {
                margin-right: 0;
                margin-bottom: 15px;
            }
            
            .svg-cell {
                height: 80px;
            }
            
            .api-table {
                font-size: 0.9em;
            }
            
            .api-table th, .api-table td {
                padding: 8px;
            }
        }
        
        @media (max-width: 480px) {
            .api-table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
        }
        
        /* ==================== Print Styles ==================== */
        @media print {
            .assignment-module {
                break-inside: avoid;
                box-shadow: none;
                border: 1px solid #ddd;
            }
            
            .overview-section {
                background: white !important;
                color: black !important;
                box-shadow: none !important;
                border: 1px solid #ddd;
            }
        }
    </style>
</head>
<body>
    <!-- Top Overview Section -->
    <section class="overview-section" id="overview">
        <h1>Assignment 5 - Integrated Assignment Showcase</h1>
        <div class="overview-content">
            <h3>Page Content Overview</h3>
            <p>This page integrates all content from Assignment 1-4, showcasing the complete work. Through a unified layout and design, four independent assignment modules are integrated into one coherent webpage.</p>
            
            <h3>Integration Process</h3>
            <p>The integration followed these principles:</p>
            <ul>
                <li>Maintain the original functionality of each assignment</li>
                <li>Create a unified CSS style system to ensure visual consistency</li>
                <li>Use modular layout to make each assignment clearly distinguishable</li>
                <li>Optimize responsive design to ensure proper display on different devices</li>
            </ul>
            
            <h3>Challenges Encountered</h3>
            <p>Main challenges included:</p>
            <ul>
                <li><strong>CSS conflicts:</strong> Different assignment style rules affected each other, requiring style system reconstruction</li>
                <li><strong>Layout differences:</strong> A1 uses table layout, A2 also uses tables but with different structure, A3 and A4 use D3.js visualizations with different layout approaches</li>
                <li><strong>Script conflicts:</strong> JavaScript code from each assignment might use the same variable or function names</li>
                <li><strong>Performance optimization:</strong> Integrating multiple D3 visualizations could affect page loading performance</li>
            </ul>
            
            <h3>Most Difficult Integration Part</h3>
            <p><strong>Integration of A3 was the most difficult.</strong> Reasons:</p>
            <ul>
                <li>A3 contains 5 independent D3 charts, each with complex interactions and animations</li>
                <li>Chart code is tightly coupled, making separation difficult</li>
                <li>Ensuring all D3 selectors work correctly after integration</li>
                <li>Handling multiple chart tooltip systems requires special care to avoid conflicts</li>
            </ul>
            
            <p><strong>Solution:</strong> Create independent containers for each chart, encapsulate respective scripts, use immediately invoked function expressions to avoid global variable pollution, and unify the tooltip system.</p>
        </div>
    </section>

    <!-- A1: Air Quality Data Table -->
    <section class="assignment-module" id="a1">
        <div class="module-header">
            <div class="module-number">1</div>
            <div>
                <h2 class="module-title">Assignment 1: Singapore Air Quality Real-time Monitoring</h2>
                <p class="module-description">Using API to fetch real-time air quality data and display in table format</p>
            </div>
        </div>
        
        <div id="a1-content">
            <div id="update" class="api-update">Loading data...</div>
            <table class="api-table" id="data-table">
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th>Central</th>
                        <th>East</th>
                        <th>West</th>
                        <th>South</th>
                        <th>North</th>
                        <th>National</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Data will be loaded here -->
                </tbody>
            </table>
        </div>
    </section>

    <!-- A2: SVG Transformations Table -->
    <section class="assignment-module" id="a2">
        <div class="module-header">
            <div class="module-number">2</div>
            <div>
                <h2 class="module-title">Assignment 2: SVG Image Transformations</h2>
                <p class="module-description">Display various SVG image transformation effects: mirror, rotation, compression, and grayscale</p>
            </div>
        </div>
        
        <div id="a2-content">
            <table class="svg-table">
                <thead>
                    <tr class="table-title-row">
                        <th colspan="5">SVG Transformations Gallery</th>
                    </tr>
                    <tr>
                        <th>ORIGINAL</th>
                        <th>MIRROR</th>
                        <th>ROTATE 180</th>
                        <th>SQUEEZE</th>
                        <th>GRAYSCALE</th>
                    </tr>
                </thead>
                <tbody id="svg-table-body">
                    <!-- SVG table rows will be dynamically generated via JavaScript -->
                </tbody>
            </table>
        </div>
    </section>

    <!-- A3: D3 Visualization Charts -->
    <section class="assignment-module" id="a3">
        <div class="module-header">
            <div class="module-number">3</div>
            <div>
                <h2 class="module-title">Assignment 3: D3 Interactive Visualizations</h2>
                <p class="module-description">Five interactive charts created using D3.js, including transition animations and hover effects</p>
            </div>
        </div>
        
        <div id="a3-content" class="chart-container">
            <!-- Chart 7: Venn Diagram -->
            <div class="chart-card">
                <h3 class="chart-title">Chart 7 ‚Äî Venn Diagram</h3>
                <p class="chart-subtitle">Three-set Venn diagram with regions I‚ÄìVII.</p>
                <div id="chart7"></div>
            </div>
            
            <!-- Chart 8: Cross Validation Accuracy Bars -->
            <div class="chart-card">
                <h3 class="chart-title">Chart 8 ‚Äî Cross Validation Accuracy Bars</h3>
                <p class="chart-subtitle">Grouped bars with a solid accuracy bar and a dashed baseline bar for each model.</p>
                <div id="chart8"></div>
            </div>
            
            <!-- Chart 9: Sketch to SVG Figure -->
            <div class="chart-card">
                <h3 class="chart-title">Chart 9 ‚Äî Sketch to SVG Figure</h3>
                <p class="chart-subtitle">Line-drawing style character sitting on a block.</p>
                <div id="chart9"></div>
            </div>
            
            <!-- Chart 10: Map with Highlighted Region -->
            <div class="chart-card">
                <h3 class="chart-title">Chart 10 ‚Äî Map with Highlighted Region</h3>
                <p class="chart-subtitle">Abstract map with four land masses and a red focus ellipse.</p>
                <div id="chart10"></div>
            </div>
            
            <!-- Chart 11: Probability Density Functions -->
            <div class="chart-card">
                <h3 class="chart-title">Chart 11 ‚Äî Probability Density Functions</h3>
                <p class="chart-subtitle">Two Gaussian curves with a shaded overlapping region and vertical reference lines.</p>
                <div id="chart11"></div>
            </div>
        </div>
    </section>

    <!-- A4: Heatmap Visualization -->
    <section class="assignment-module" id="a4">
        <div class="module-header">
            <div class="module-number">4</div>
            <div>
                <h2 class="module-title">Assignment 4: Machine Learning Model Robustness Heatmap</h2>
                <p class="module-description">Analysis of robustness of different defense methods against adversarial attacks</p>
            </div>
        </div>
        
        <div id="a4-content">
            <div class="analysis-section">
                <h3>üìà Visualization Overview</h3>
                <p><strong>Data Background:</strong> This heatmap visualizes the robustness of 9 machine learning defense methods against 26 different adversarial attacks. Each cell color represents the classification accuracy of a model under a specific attack scenario.</p>
                
                <p><strong>Interactive Features:</strong></p>
                <ul>
                    <li>üéØ <strong>Mouse Hover</strong> - View detailed data for any cell (attack method, defense method, accuracy rate)</li>
                    <li>üåà <strong>Color Interpretation</strong> - Red (0-30%) indicates weak defense, Yellow (30-70%) moderate performance, Green (70-100%) strong defense</li>
                    <li>üìä <strong>Pattern Recognition</strong> - Observe color trends across rows/columns to analyze overall effectiveness of specific attacks or defenses</li>
                </ul>
                
                <p><strong>Key Insights:</strong></p>
                <ul>
                    <li>üõ°Ô∏è <strong>Best Defense</strong> - TandT method maintains high accuracy against most attacks (most green cells)</li>
                    <li>‚öîÔ∏è <strong>Strongest Attacks</strong> - MIFGSM, APGD methods effectively reduce accuracy of most defenses</li>
                    <li>üéØ <strong>Targeted Effectiveness</strong> - Certain attacks work particularly well against specific defenses (e.g., Pixle attack affects all defenses)</li>
                </ul>
            </div>
            
            <div class="heatmap-container">
                <div id="chart"></div>
            </div>
            
            <div class="heatmap-legend">
                <span><strong>Low Accuracy (0%)</strong></span>
                <div class="color-bar"></div>
                <span><strong>High Accuracy (100%)</strong></span>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer style="text-align: center; margin-top: 40px; padding: 20px; color: #666; border-top: 1px solid #eee;">
        <p>Assignment 5 - Integrated Assignment Showcase | All assignment functionalities remain fully operational</p>
        <p>¬© 2023 Data Visualization Course Project</p>
    </footer>

    <!-- ==================== JavaScript Code ==================== -->
    <script>
        // ==================== A1: Air Quality API ====================
        (function() {
            const labels = {
                "o3_sub_index": "Ozone Sub Index (O‚ÇÉ)",
                "pm10_twenty_four_hourly": "PM‚ÇÅ‚ÇÄ 24-Hour Average",
                "pm10_sub_index": "PM‚ÇÅ‚ÇÄ Sub Index",
                "co_sub_index": "Carbon Monoxide Sub Index (CO)",
                "pm25_twenty_four_hourly": "PM‚ÇÇ.‚ÇÖ 24-Hour Average",
                "so2_sub_index": "Sulfur Dioxide Sub Index (SO‚ÇÇ)",
                "co_eight_hour_max": "CO 8-Hour Max",
                "no2_one_hour_max": "Nitrogen Dioxide 1-Hour Max (NO‚ÇÇ)",
                "so2_twenty_four_hourly": "SO‚ÇÇ 24-Hour Average",
                "pm25_sub_index": "PM‚ÇÇ.‚ÇÖ Sub Index",
                "psi_twenty_four_hourly": "Pollutant Standards Index (PSI)",
                "o3_eight_hour_max": "Ozone 8-Hour Max"
            };

            async function loadData() {
                try {
                    const res = await fetch("https://api.data.gov.sg/v1/environment/psi");
                    const json = await res.json();
                    const readings = json.items[0].readings;
                    const regions = Object.keys(readings.psi_twenty_four_hourly);
                    const tbody = document.querySelector("#data-table tbody");
                    const update = document.getElementById("update");
                    
                    // Format timestamp
                    const time = new Date(json.items[0].update_timestamp).toLocaleString("en-SG", { 
                        timeZone: "Asia/Singapore",
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit'
                    });
                    update.textContent = `Last Updated: ${time}`;
                    tbody.innerHTML = "";
                    
                    // Create table rows
                    for (const key in readings) {
                        const row = document.createElement("tr");
                        const label = labels[key] || key;
                        
                        // Create label cell
                        const labelCell = document.createElement("td");
                        labelCell.textContent = label;
                        labelCell.style.fontWeight = "bold";
                        row.appendChild(labelCell);
                        
                        // Create data cells for each region
                        regions.forEach(region => {
                            const dataCell = document.createElement("td");
                            const value = readings[key][region];
                            dataCell.textContent = typeof value === 'number' ? value.toFixed(1) : value;
                            row.appendChild(dataCell);
                        });
                        
                        tbody.appendChild(row);
                    }
                } catch (error) {
                    console.error("Failed to load data:", error);
                    document.getElementById("update").textContent = "Failed to load data. Please try again later.";
                    document.querySelector("#data-table tbody").innerHTML = `
                        <tr>
                            <td colspan="7" style="text-align: center; padding: 20px; color: #ff6b6b;">
                                Unable to load data from API. Please check your internet connection.
                            </td>
                        </tr>
                    `;
                }
            }

            // Initial load and refresh every minute
            loadData();
            setInterval(loadData, 60000);
        })();

        // ==================== A2: SVG Transformations Table ====================
        (function() {
            const svgFiles = ['one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten'];
            const tableBody = document.getElementById('svg-table-body');
            
            svgFiles.forEach(fileName => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="svg-cell">
                        <div class="svg-frame">
                            <img src="${fileName}.svg" alt="original ${fileName}.svg">
                        </div>
                    </td>
                    <td class="svg-cell">
                        <div class="svg-frame mirror">
                            <img src="${fileName}.svg" alt="mirror ${fileName}.svg">
                        </div>
                    </td>
                    <td class="svg-cell">
                        <div class="svg-frame rotate180">
                            <img src="${fileName}.svg" alt="rotate180 ${fileName}.svg">
                        </div>
                    </td>
                    <td class="svg-cell">
                        <div class="svg-frame squeezeY">
                            <img src="${fileName}.svg" alt="squeezeY ${fileName}.svg">
                        </div>
                    </td>
                    <td class="svg-cell">
                        <div class="svg-frame grayscale">
                            <img src="${fileName}.svg" alt="grayscale ${fileName}.svg">
                        </div>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        })();

        // ==================== A3: D3 Visualizations ====================
        (function() {
            // Shared tooltip (for bar chart)
            const tooltip = d3.select("body")
                .append("div")
                .attr("class", "tooltip")
                .style("opacity", 0);

            // Chart 7: Venn diagram
            function drawChart7() {
                const width = 420;
                const height = 260;
                const svg = d3.select("#chart7")
                    .append("svg")
                    .attr("width", width)
                    .attr("height", height);

                const g = svg.append("g")
                    .attr("transform", "translate(0,10)");

                const circles = [
                    { id: "A", cx: 150, cy: 120, r: 80, color: "#c4b5fd", label: "Delete" },
                    { id: "B", cx: 220, cy: 80, r: 80, color: "#bfdbfe", label: "Replace" },
                    { id: "C", cx: 260, cy: 140, r: 80, color: "#fde68a", label: "Rewrite" }
                ];

                const circleSelection = g.selectAll("circle.venn")
                    .data(circles)
                    .enter()
                    .append("circle")
                    .attr("class", "venn")
                    .attr("cx", d => d.cx)
                    .attr("cy", d => d.cy)
                    .attr("r", 0)
                    .attr("fill", d => d.color)
                    .attr("fill-opacity", 0.2)
                    .attr("stroke", "#4b5563")
                    .attr("stroke-width", 1)
                    .on("mouseover", function(event, d) {
                        d3.select(this)
                            .transition().duration(200)
                            .attr("r", d.r + 6)
                            .attr("fill-opacity", 0.8);
                    })
                    .on("mouseout", function(event, d) {
                        d3.select(this)
                            .transition().duration(200)
                            .attr("r", d.r)
                            .attr("fill-opacity", 0.55);
                    });

                // Grow circles on load
                circleSelection
                    .transition()
                    .duration(800)
                    .attr("r", d => d.r)
                    .attr("fill-opacity", 0.55);

                const labels = [
                    { text: "I", x: 90, y: 140 },
                    { text: "II", x: 220, y: 30 },
                    { text: "III", x: 330, y: 145 },
                    { text: "IV", x: 165, y: 115 },
                    { text: "V", x: 235, y: 110 },
                    { text: "VI", x: 205, y: 150 },
                    { text: "VII", x: 220, y: 130 }
                ];

                g.selectAll("text.region")
                    .data(labels)
                    .enter()
                    .append("text")
                    .attr("class", "region")
                    .attr("x", d => d.x)
                    .attr("y", d => d.y)
                    .attr("text-anchor", "middle")
                    .attr("dominant-baseline", "central")
                    .style("font-size", "13px")
                    .style("fill", "#111827")
                    .style("opacity", 0)
                    .transition()
                    .delay(700)
                    .duration(500)
                    .style("opacity", 1)
                    .text(d => d.text);

                g.append("text")
                    .attr("x", 70)
                    .attr("y", 30)
                    .style("font-size", "12px")
                    .style("opacity", 0)
                    .text("Delete")
                    .transition().delay(700).duration(500).style("opacity", 1);

                g.append("text")
                    .attr("x", 210)
                    .attr("y", 20)
                    .style("font-size", "12px")
                    .style("opacity", 0)
                    .text("Replace")
                    .transition().delay(700).duration(500).style("opacity", 1);

                g.append("text")
                    .attr("x", 330)
                    .attr("y", 40)
                    .style("font-size", "12px")
                    .style("opacity", 0)
                    .text("Rewrite")
                    .transition().delay(700).duration(500).style("opacity", 1);
            }

            // Chart 8: Simple bars
            function drawChart8() {
                const data = [
                    { model: "BERT", base: 74.4, dashed: 64.8 },
                    { model: "RoBERTa", base: 81.9, dashed: 65.5 },
                    { model: "BART", base: 73.1, dashed: 63.5 }
                ];

                const margin = { top: 40, right: 20, bottom: 40, left: 40 };
                const width = 420 - margin.left - margin.right;
                const height = 240 - margin.top - margin.bottom;

                const svg = d3.select("#chart8")
                    .append("svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", `translate(${margin.left},${margin.top})`);

                const x = d3.scaleBand()
                    .domain(data.map(d => d.model))
                    .range([0, width])
                    .padding(0.4);

                const y = d3.scaleLinear()
                    .domain([0, 100])
                    .nice()
                    .range([height, 0]);

                svg.append("g")
                    .attr("transform", `translate(0,${height})`)
                    .call(d3.axisBottom(x));

                svg.append("g")
                    .call(d3.axisLeft(y).ticks(5));

                svg.append("line")
                    .attr("x1", 0)
                    .attr("x2", width)
                    .attr("y1", height)
                    .attr("y2", height)
                    .attr("stroke", "#111827")
                    .attr("stroke-width", 1);

                const bars = svg.selectAll(".bar-base")
                    .data(data)
                    .enter()
                    .append("rect")
                    .attr("class", "bar-base")
                    .attr("x", d => x(d.model))
                    .attr("width", x.bandwidth())
                    .attr("y", height)
                    .attr("height", 0)
                    .attr("fill", "#f9e4a4")
                    .attr("stroke", "#b38f3b")
                    .attr("stroke-width", 0.8)
                    .on("mouseover", function(event, d) {
                        d3.select(this)
                            .transition().duration(200)
                            .attr("y", y(d.base) - 5)
                            .attr("height", height - y(d.base) + 5)
                            .attr("fill", "#fde68a");
                        tooltip
                            .style("opacity", 1)
                            .html(`<strong>${d.model}</strong><br/>Accuracy: ${d.base}%`)
                            .style("left", (event.pageX + 10) + "px")
                            .style("top", (event.pageY - 28) + "px");
                    })
                    .on("mouseout", function(event, d) {
                        d3.select(this)
                            .transition().duration(200)
                            .attr("y", y(d.base))
                            .attr("height", height - y(d.base))
                            .attr("fill", "#f9e4a4");
                        tooltip.style("opacity", 0);
                    });

                // Load animation
                bars.transition()
                    .delay((d, i) => i * 200)
                    .duration(800)
                    .attr("y", d => y(d.base))
                    .attr("height", d => height - y(d.base));

                svg.selectAll(".bar-dashed")
                    .data(data)
                    .enter()
                    .append("rect")
                    .attr("class", "bar-dashed")
                    .attr("x", d => x(d.model) + x.bandwidth() * 0.1)
                    .attr("width", x.bandwidth() * 0.8)
                    .attr("y", d => y(d.dashed))
                    .attr("height", d => height - y(d.dashed))
                    .attr("fill", "none")
                    .attr("stroke", "#d4b866")
                    .attr("stroke-dasharray", "4,3")
                    .attr("stroke-width", 1.2)
                    .style("opacity", 0)
                    .transition()
                    .delay(700)
                    .duration(500)
                    .style("opacity", 1);

                svg.selectAll(".label-base")
                    .data(data)
                    .enter()
                    .append("text")
                    .attr("class", "label-base")
                    .attr("x", d => x(d.model) + x.bandwidth() / 2)
                    .attr("y", d => y(d.base) - 6)
                    .attr("text-anchor", "middle")
                    .style("font-size", "11px")
                    .style("opacity", 0)
                    .text(d => d.base.toFixed(1))
                    .transition()
                    .delay(700)
                    .duration(500)
                    .style("opacity", 1);

                svg.selectAll(".label-dashed")
                    .data(data)
                    .enter()
                    .append("text")
                    .attr("class", "label-dashed")
                    .attr("x", d => x(d.model) + x.bandwidth() / 2)
                    .attr("y", d => y(d.dashed) + 12)
                    .attr("text-anchor", "middle")
                    .style("font-size", "10px")
                    .style("fill", "#6b7280")
                    .style("opacity", 0)
                    .text(d => d.dashed.toFixed(1))
                    .transition()
                    .delay(700)
                    .duration(500)
                    .style("opacity", 1);

                svg.append("text")
                    .attr("x", width / 2)
                    .attr("y", -15)
                    .attr("text-anchor", "middle")
                    .style("font-size", "13px")
                    .style("font-weight", "bold")
                    .text("Cross Validation Accuracy (%)");
            }

            // Chart 9: Sketch to SVG
            function drawChart9() {
                const width = 360;
                const height = 220;
                const svg = d3.select("#chart9")
                    .append("svg")
                    .attr("width", width)
                    .attr("height", height)
                    .style("background", "#f9fafb");

                const g = svg.append("g")
                    .attr("transform", "translate(40,15)")
                    .attr("stroke", "#4b5563")
                    .attr("fill", "none")
                    .attr("stroke-linecap", "round")
                    .attr("stroke-linejoin", "round")
                    .style("opacity", 0);

                // Block
                g.append("rect")
                    .attr("x", 30)
                    .attr("y", 110)
                    .attr("width", 220)
                    .attr("height", 40)
                    .attr("fill", "#e5e7eb")
                    .attr("stroke-width", 1.2);

                // Body
                g.append("line").attr("x1", 140).attr("y1", 80).attr("x2", 140).attr("y2", 120).attr("stroke-width", 1.5);
                
                // Head
                g.append("rect")
                    .attr("x", 115)
                    .attr("y", 30)
                    .attr("width", 50)
                    .attr("height", 40)
                    .attr("fill", "#f3f4f6")
                    .attr("stroke-width", 1.5);

                // Face
                g.append("line").attr("x1", 125).attr("y1", 48).attr("x2", 135).attr("y2", 48);
                g.append("line").attr("x1", 146).attr("y1", 48).attr("x2", 156).attr("y2", 48);
                g.append("line").attr("x1", 130).attr("y1", 58).attr("x2", 150).attr("y2", 58);

                // Legs
                g.append("line").attr("x1", 140).attr("y1", 120).attr("x2", 120).attr("y2", 150);
                g.append("line").attr("x1", 120).attr("y1", 150).attr("x2", 115).attr("y2", 165);
                g.append("line").attr("x1", 140).attr("y1", 120).attr("x2", 155).attr("y2", 150);
                g.append("line").attr("x1", 155).attr("y1", 150).attr("x2", 160).attr("y2", 165);

                // Arms & stick
                g.append("line").attr("x1", 140).attr("y1", 90).attr("x2", 110).attr("y2", 110);
                g.append("line").attr("x1", 140).attr("y1", 90).attr("x2", 170).attr("y2", 105);
                g.append("line").attr("x1", 105).attr("y1", 108).attr("x2", 185).attr("y2", 130);

                // Hand circles
                g.append("circle").attr("cx", 110).attr("cy", 110).attr("r", 3).attr("fill", "#4b5563");
                g.append("circle").attr("cx", 170).attr("cy", 105).attr("r", 3).attr("fill", "#4b5563");

                // Fade-in animation
                g.transition()
                    .duration(800)
                    .style("opacity", 1);

                // Hover: stroke width change
                g.on("mouseover", function() {
                    d3.select(this).transition().duration(150).attr("stroke-width", 2);
                })
                .on("mouseout", function() {
                    d3.select(this).transition().duration(150).attr("stroke-width", 1.2);
                });
            }

            // Chart 10: Map
            function drawChart10() {
                const width = 360;
                const height = 260;
                const svg = d3.select("#chart10")
                    .append("svg")
                    .attr("width", width)
                    .attr("height", height)
                    .style("background", "#f9fafb");

                const margin = { top: 20, right: 20, bottom: 20, left: 20 };
                const innerWidth = width - margin.left - margin.right;
                const innerHeight = height - margin.top - margin.bottom;

                const g = svg.append("g")
                    .attr("transform", `translate(${margin.left},${margin.top}) scale(0.8)`)
                    .style("opacity", 0.2);

                // Grid
                const step = 24;
                for (let x = 0; x <= innerWidth; x += step) {
                    g.append("line")
                        .attr("x1", x)
                        .attr("y1", 0)
                        .attr("x2", x)
                        .attr("y2", innerHeight)
                        .attr("stroke", "#e5e7eb")
                        .attr("stroke-width", 0.6);
                }
                for (let y = 0; y <= innerHeight; y += step) {
                    g.append("line")
                        .attr("x1", 0)
                        .attr("y1", y)
                        .attr("x2", innerWidth)
                        .attr("y2", y)
                        .attr("stroke", "#e5e7eb")
                        .attr("stroke-width", 0.6);
                }

                // Land polygons
                const land = [
                    [[40, 40],[110, 35],[140, 60],[120, 110],[60, 100]],
                    [[170, 50],[240, 45],[260, 80],[230, 110],[185, 95]],
                    [[70, 150],[120, 145],[150, 175],[130, 210],[80, 200]],
                    [[190, 150],[250, 160],[260, 195],[220, 210],[190, 190]]
                ];

                g.selectAll("polygon.land")
                    .data(land)
                    .enter()
                    .append("polygon")
                    .attr("class", "land")
                    .attr("points", d => d.map(p => p.join(",")).join(" "))
                    .attr("fill", "#f4d7a4")
                    .attr("stroke", "#d1a65a")
                    .attr("stroke-width", 0.8)
                    .on("mouseover", function() {
                        d3.select(this)
                            .transition().duration(200)
                            .attr("fill", "#fde7b4");
                    })
                    .on("mouseout", function() {
                        d3.select(this)
                            .transition().duration(200)
                            .attr("fill", "#f4d7a4");
                    });

                // Focus ellipse
                g.append("ellipse")
                    .attr("cx", innerWidth * 0.55)
                    .attr("cy", innerHeight * 0.45)
                    .attr("rx", 90)
                    .attr("ry", 70)
                    .attr("fill", "none")
                    .attr("stroke", "#dc2626")
                    .attr("stroke-width", 2);

                // Zoom + fade-in animation
                g.transition()
                    .duration(900)
                    .attr("transform", `translate(${margin.left},${margin.top}) scale(1)`)
                    .style("opacity", 1);

                svg.append("text")
                    .attr("x", width / 2)
                    .attr("y", 16)
                    .attr("text-anchor", "middle")
                    .style("font-size", "12px")
                    .text("Abstract Map with Focus Region");
            }

            // Chart 11: Functions
            function drawChart11() {
                const margin = { top: 30, right: 20, bottom: 40, left: 45 };
                const width = 420 - margin.left - margin.right;
                const height = 260 - margin.top - margin.bottom;

                const svg = d3.select("#chart11")
                    .append("svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", `translate(${margin.left},${margin.top})`);

                const x = d3.scaleLinear()
                    .domain([-2, 5])
                    .range([0, width]);

                const y = d3.scaleLinear()
                    .domain([0, 0.35])
                    .range([height, 0]);

                svg.append("g")
                    .attr("transform", `translate(0,${height})`)
                    .call(d3.axisBottom(x).ticks(7));

                svg.append("g")
                    .call(d3.axisLeft(y).ticks(5));

                svg.append("text")
                    .attr("x", width / 2)
                    .attr("y", height + 32)
                    .attr("text-anchor", "middle")
                    .style("font-size", "12px")
                    .text("x");

                svg.append("text")
                    .attr("transform", "rotate(-90)")
                    .attr("x", -height / 2)
                    .attr("y", -32)
                    .attr("text-anchor", "middle")
                    .style("font-size", "12px")
                    .text("Probability Density");

                // Gaussian function
                function gaussian(xVal, mu, sigma) {
                    const coeff = 1 / (Math.sqrt(2 * Math.PI) * sigma);
                    const expo = -Math.pow(xVal - mu, 2) / (2 * sigma * sigma);
                    return coeff * Math.exp(expo);
                }

                const xs = d3.range(-2, 5.01, 0.05);
                const data0 = xs.map(d => ({ x: d, y: gaussian(d, 0.2, 0.9) }));
                const data1 = xs.map(d => ({ x: d, y: gaussian(d, 1.8, 0.8) }));

                const lineGen = d3.line()
                    .x(d => x(d.x))
                    .y(d => y(d.y));

                // Overlap area
                const overlap = xs.map(d => {
                    const y0 = gaussian(d, 0.2, 0.9);
                    const y1 = gaussian(d, 1.8, 0.8);
                    return { x: d, y: Math.min(y0, y1) };
                });

                const areaOverlap = d3.area()
                    .x(d => x(d.x))
                    .y0(y(0))
                    .y1(d => y(d.y));

                const overlapPath = svg.append("path")
                    .datum(overlap)
                    .attr("fill", "#9ca3af")
                    .attr("opacity", 0)
                    .attr("d", areaOverlap);

                overlapPath
                    .transition()
                    .duration(700)
                    .attr("opacity", 0.5);

                // First curve
                const path0 = svg.append("path")
                    .datum(data0)
                    .attr("fill", "none")
                    .attr("stroke", "#f59e0b")
                    .attr("stroke-width", 2)
                    .attr("d", lineGen)
                    .on("mouseover", function() {
                        d3.select(this).transition().duration(150).attr("stroke-width", 3);
                    })
                    .on("mouseout", function() {
                        d3.select(this).transition().duration(150).attr("stroke-width", 2);
                    });

                const length0 = path0.node().getTotalLength();
                path0
                    .attr("stroke-dasharray", length0 + " " + length0)
                    .attr("stroke-dashoffset", length0)
                    .transition()
                    .delay(400)
                    .duration(900)
                    .attr("stroke-dashoffset", 0);

                // Second curve
                const path1 = svg.append("path")
                    .datum(data1)
                    .attr("fill", "none")
                    .attr("stroke", "#0ea5e9")
                    .attr("stroke-width", 2)
                    .attr("d", lineGen)
                    .on("mouseover", function() {
                        d3.select(this).transition().duration(150).attr("stroke-width", 3);
                    })
                    .on("mouseout", function() {
                        d3.select(this).transition().duration(150).attr("stroke-width", 2);
                    });

                const length1 = path1.node().getTotalLength();
                path1
                    .attr("stroke-dasharray", length1 + " " + length1)
                    .attr("stroke-dashoffset", length1)
                    .transition()
                    .delay(700)
                    .duration(900)
                    .attr("stroke-dashoffset", 0);

                // Overlap area hover effect
                overlapPath
                    .on("mouseover", function() {
                        d3.select(this).transition().duration(150).attr("opacity", 0.8);
                    })
                    .on("mouseout", function() {
                        d3.select(this).transition().duration(150).attr("opacity", 0.5);
                    });

                // Vertical reference lines
                const vlines = [0, 1, 2];
                svg.selectAll(".vline")
                    .data(vlines)
                    .enter()
                    .append("line")
                    .attr("class", "vline")
                    .attr("x1", d => x(d))
                    .attr("x2", d => x(d))
                    .attr("y1", height)
                    .attr("y2", 0)
                    .attr("stroke", "#6b7280")
                    .attr("stroke-dasharray", "4,3")
                    .attr("stroke-width", 1);

                // Legend
                const legend = svg.append("g")
                    .attr("transform", `translate(${width - 160}, 10)`);

                legend.append("line")
                    .attr("x1", 0).attr("y1", 0)
                    .attr("x2", 26).attr("y2", 0)
                    .attr("stroke", "#f59e0b")
                    .attr("stroke-width", 2);

                legend.append("text")
                    .attr("x", 32).attr("y", 3)
                    .style("font-size", "11px")
                    .text("p(x, y = 0) * v(x)");

                legend.append("line")
                    .attr("x1", 0).attr("y1", 16)
                    .attr("x2", 26).attr("y2", 16)
                    .attr("stroke", "#0ea5e9")
                    .attr("stroke-width", 2);

                legend.append("text")
                    .attr("x", 32).attr("y", 19)
                    .style("font-size", "11px")
                    .text("p(x, y = 1) * v(x)");
            }

            // Draw all charts
            drawChart7();
            drawChart8();
            drawChart9();
            drawChart10();
            drawChart11();
        })();

        // ==================== A4: Heatmap ====================
        (function() {
            // Data
            const data = {
                "No Attack": {"ERM": 94.85, "DA": 94.21, "PGDT": 84.38, "TRADES": 80.42, "MART": 81.54, "RS": 89.45, "IBP": 48.4, "PRL": 93.82, "TandT": 94.23},
                "TIFGSM": {"ERM": 35.1, "DA": 33.0, "PGDT": 65.7, "TRADES": 62.9, "MART": 69.1, "RS": 45.4, "IBP": 40.2, "PRL": 34.0, "TandT": 92.8},
                "MIFGSM": {"ERM": 0.0, "DA": 0.0, "PGDT": 50.9, "TRADES": 51.9, "MART": 50.5, "RS": 5.8, "IBP": 38.1, "PRL": 0.0, "TandT": 92.8},
                "DIFGSM": {"ERM": 1.0, "DA": 0.0, "PGDT": 51.75, "TRADES": 50.5, "MART": 53.6, "RS": 4.1, "IBP": 38.1, "PRL": 3.1, "TandT": 92.8},
                "VMIFGSM": {"ERM": 0.0, "DA": 0.0, "PGDT": 51.1, "TRADES": 50.9, "MART": 51.9, "RS": 4.1, "IBP": 38.1, "PRL": 0.0, "TandT": 93.9},
                "TPGD": {"ERM": 38.1, "DA": 39.2, "PGDT": 69.3, "TRADES": 69.1, "MART": 70.1, "RS": 48.5, "IBP": 50.0, "PRL": 28.9, "TandT": 91.8},
                "FGSM": {"ERM": 29.9, "DA": 25.8, "PGDT": 57.95, "TRADES": 54.6, "MART": 61.9, "RS": 28.9, "IBP": 38.1, "PRL": 25.8, "TandT": 93.8},
                "RFGSM": {"ERM": 0.0, "DA": 0.0, "PGDT": 49.15, "TRADES": 50.4, "MART": 48.5, "RS": 3.7, "IBP": 38.1, "PRL": 0.0, "TandT": 90.0},
                "BIM": {"ERM": 0.0, "DA": 0.0, "PGDT": 52.0, "TRADES": 57.2, "MART": 47.4, "RS": 2.1, "IBP": 38.1, "PRL": 0.0, "TandT": 90.7},
                "FAB": {"ERM": 1.0, "DA": 2.1, "PGDT": 43.0, "TRADES": 46.4, "MART": 40.2, "RS": 5.3, "IBP": 38.1, "PRL": 4.1, "TandT": 90.1},
                "CW": {"ERM": 0.0, "DA": 0.0, "PGDT": 32.2, "TRADES": 35.1, "MART": 29.9, "RS": 1.0, "IBP": 40.2, "PRL": 1.0, "TandT": 92.9},
                "UPGD": {"ERM": 0.0, "DA": 0.0, "PGDT": 49.85, "TRADES": 50.5, "MART": 49.8, "RS": 5.1, "IBP": 38.1, "PRL": 0.0, "TandT": 93.8},
                "FFGSM": {"ERM": 19.6, "DA": 23.7, "PGDT": 60.55, "TRADES": 55.7, "MART": 66.0, "RS": 33.0, "IBP": 42.3, "PRL": 29.9, "TandT": 92.8},
                "Jitter": {"ERM": 11.3, "DA": 12.4, "PGDT": 48.15, "TRADES": 47.4, "MART": 49.5, "RS": 34.0, "IBP": 39.2, "PRL": 24.7, "TandT": 90.7},
                "PGD": {"ERM": 0.0, "DA": 0.0, "PGDT": 57.4, "TRADES": 54.6, "MART": 60.8, "RS": 7.2, "IBP": 40.2, "PRL": 0.0, "TandT": 91.8},
                "EOTPGD": {"ERM": 0.0, "DA": 0.0, "PGDT": 50.1, "TRADES": 50.3, "MART": 50.5, "RS": 3.0, "IBP": 38.1, "PRL": 0.0, "TandT": 90.7},
                "APGD": {"ERM": 0.0, "DA": 0.0, "PGDT": 48.4, "TRADES": 51.0, "MART": 46.4, "RS": 1.0, "IBP": 38.1, "PRL": 0.0, "TandT": 90.7},
                "NIFGSM": {"ERM": 0.0, "DA": 0.0, "PGDT": 57.95, "TRADES": 56.7, "MART": 59.8, "RS": 7.2, "IBP": 38.1, "PRL": 1.0, "TandT": 92.8},
                "SiniFGSM": {"ERM": 4.1, "DA": 1.0, "PGDT": 59.0, "TRADES": 56.7, "MART": 61.9, "RS": 23.7, "IBP": 38.1, "PRL": 12.4, "TandT": 93.7},
                "VNIFGSM": {"ERM": 0.0, "DA": 0.0, "PGDT": 50.45, "TRADES": 53.0, "MART": 48.5, "RS": 5.1, "IBP": 38.1, "PRL": 0.0, "TandT": 92.9},
                "APGDT": {"ERM": 0.0, "DA": 0.0, "PGDT": 40.9, "TRADES": 44.3, "MART": 38.1, "RS": 0.0, "IBP": 38.1, "PRL": 0.0, "TandT": 88.7},
                "Square": {"ERM": 0.0, "DA": 1.0, "PGDT": 50.4, "TRADES": 54.0, "MART": 47.4, "RS": 3.1, "IBP": 38.1, "PRL": 2.1, "TandT": 88.08},
                "Add Gaussian Noise": {"ERM": 25.8, "DA": 43.3, "PGDT": 79.1, "TRADES": 78.4, "MART": 80.4, "RS": 74.2, "IBP": 42.3, "PRL": 45.4, "TandT": 87.6},
                "OnePixel": {"ERM": 79.4, "DA": 83.5, "PGDT": 78.05, "TRADES": 74.2, "MART": 82.5, "RS": 83.5, "IBP": 42.5, "PRL": 80.4, "TandT": 89.7},
                "Pixle": {"ERM": 0.0, "DA": 0.0, "PGDT": 12.55, "TRADES": 11.3, "MART": 14.4, "RS": 1.0, "IBP": 10.3, "PRL": 0.0, "TandT": 17.5},
                "PGDL2": {"ERM": 1.0, "DA": 0.0, "PGDT": 35.8, "TRADES": 36.1, "MART": 36.1, "RS": 5.2, "IBP": 36.1, "PRL": 0.0, "TandT": 92.9}
            };

            // Create chart - Horizontal layout
            const margin = { top: 50, right: 30, bottom: 100, left: 120 };
            const width = 1100 - margin.left - margin.right;
            const height = 600 - margin.top - margin.bottom;

            const svg = d3.select("#chart")
                .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);

            const colorScale = d3.scaleLinear()
                .range(["#e74c3c", "#f1c40f", "#27ae60"])
                .domain([0, 50, 100]);

            // Defense methods on X-axis, Attack methods on Y-axis
            const xScale = d3.scaleBand()
                .range([0, width])
                .padding(0.05);

            const yScale = d3.scaleBand()
                .range([0, height])
                .padding(0.05);

            // Process data
            const defenseMethods = Object.keys(data["No Attack"]);
            const attackMethods = Object.keys(data);

            xScale.domain(defenseMethods);
            yScale.domain(attackMethods);

            // Draw Y-axis (Attack Methods)
            svg.append("g")
                .call(d3.axisLeft(yScale))
                .selectAll("text")
                .style("font-size", "10px");

            // Draw X-axis (Defense Methods)
            svg.append("g")
                .attr("transform", `translate(0, ${height})`)
                .call(d3.axisBottom(xScale))
                .selectAll("text")
                .attr("transform", "rotate(-45)")
                .style("text-anchor", "end")
                .style("font-size", "10px")
                .attr("dx", "-0.8em")
                .attr("dy", "0.15em");

            // Draw heatmap cells
            attackMethods.forEach(attack => {
                defenseMethods.forEach(defense => {
                    const value = data[attack][defense];
                    
                    svg.append("rect")
                        .attr("class", "cell")
                        .attr("x", xScale(defense))
                        .attr("y", yScale(attack))
                        .attr("width", xScale.bandwidth())
                        .attr("height", yScale.bandwidth())
                        .style("fill", colorScale(value))
                        .style("stroke", "#fff")
                        .style("stroke-width", 1)
                        .on("mouseover", function(event) {
                            d3.select(this)
                                .style("stroke", "#2c3e50")
                                .style("stroke-width", 2);
                            
                            const tooltip = d3.select("body").append("div")
                                .style("position", "absolute")
                                .style("background", "rgba(44, 62, 80, 0.95)")
                                .style("color", "white")
                                .style("padding", "10px")
                                .style("border-radius", "5px")
                                .style("font-size", "12px")
                                .style("left", (event.pageX + 10) + "px")
                                .style("top", (event.pageY - 40) + "px")
                                .html(`
                                    <div style="margin-bottom: 5px;"><strong>Attack Method:</strong> ${attack}</div>
                                    <div style="margin-bottom: 5px;"><strong>Defense Method:</strong> ${defense}</div>
                                    <div><strong>Accuracy:</strong> ${value}%</div>
                                `);
                        })
                        .on("mouseout", function() {
                            d3.select(this)
                                .style("stroke", "#fff")
                                .style("stroke-width", 1);
                            d3.selectAll("div").filter(function() {
                                return this.style.position === 'absolute';
                            }).remove();
                        });
                });
            });

            // Add axis labels
            svg.append("text")
                .attr("transform", "rotate(-90)")
                .attr("y", 0 - margin.left + 20)
                .attr("x", 0 - (height / 2))
                .attr("dy", "1em")
                .style("text-anchor", "middle")
                .text("Attack Methods");

            svg.append("text")
                .attr("transform", `translate(${width / 2}, ${height + margin.bottom - 20})`)
                .style("text-anchor", "middle")
                .text("Defense Methods");
        })();
    </script>
</body>
</html>
